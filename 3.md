
## ูุน ุฃูุซูุฉ ุนูููุฉ  

---

### **1. ููุงุฐุง CSRF ูุง ูุญุชุงุฌ ุงุฎุชุฑุงูุ**
- **ุงูุณุจุจ**: ูุณุชุบู CSRF (Cross-Site Request Forgery) ุซูุฉ ุงููููุน ุจุงููุณุชุฎุฏู ุงููุณุฌู ุจุงููุนู.
- **ุงููุซุงู**:  
  ```html
  <!-- ุตูุญุฉ ุฎุจูุซุฉ -->
  <img src="https://bank.com/transfer?to=hacker&amount=1000" width="0" height="0">
  ```
  **ุงูุชุฃุซูุฑ**: ูู ูุงู ุงููุณุชุฎุฏู ูุณุฌููุง ูู ุงูุจูู ููุชุญ ูุฐู ุงูุตูุญุฉุ ุณูุชู ุชุญููู ุงูุฃููุงู ุฏูู ุนููู.

---

### **2. ููุงุฐุง ุงูุฌูุณุฉ ูุญุฏูุง ูุง ุชูููุ**
- **ุงูุณุจุจ**: ุงูุฌูุณุฉ (Session) ุชุซุจุช ูููุฉ ุงููุณุชุฎุฏูุ ููููุง ูุง ุชุซุจุช ุฃู ุงูุทูุจ ุฌุงุก ูู ูููุนู ุงูุญูููู.
- **ุงููุซุงู**:  
  ```javascript
  // ูุฌูู CSRF ุนุจุฑ ูููุฐุฌ ูุฎูู
  <form action="https://site.com/change-email" method="POST">
    <input type="hidden" name="email" value="hacker@evil.com">
  </form>
  <script>document.forms[0].submit()</script>
  ```
  **ุงููุชูุฌุฉ**: ุชุบููุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฑุบู ูุฌูุฏ ุฌูุณุฉ ุตุงูุญุฉ.

---

### **3. ูุง ุงููุฑู ุจูู CSRF ู XSSุ**
| **CSRF** | **XSS** |
|----------|---------|
| ูุฎุฏุน ุงููุณุชุฎุฏู ูุชูููุฐ ุทูุจ ุนูู ูููุน ุขุฎุฑ | ูุญูู ููุฏ ุฎุจูุซ ูู ุงููููุน ููุณู |
| ูุง ูุญุชุงุฌ ูุงุฎุชุฑุงู ุงููููุน | ูุญุชุงุฌ ูุซุบุฑุฉ ูู ุงููููุน |
| ูุณุชุบู ุซูุฉ ุงููููุน ุจุงููุณุชุฎุฏู | ูุณุชุบู ุซูุฉ ุงููุณุชุฎุฏู ุจุงููููุน |
- **ูุซุงู XSS**:  
  ```html
  <script>alert(document.cookie)</script>
  ```

---

### **4. ููุงุฐุง ุฑูุน ุงููููุงุช ุฃุฎุทุฑ ูู SQL Injectionุ**
- **ุงูุณุจุจ**: ูุฏ ูุคุฏู ูุชูููุฐ ููุฏ ุฎุจูุซ ุนูู ุงูุฎุงุฏูุ ุจูููุง SQL Injection ููุชุตุฑ ุนุงุฏุฉ ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
- **ุงููุซุงู**: ุฑูุน ููู `shell.php` ูุนุทู ุงูููุงุฌู ุชุญูููุง ูุงููุงู ูู ุงูุฎุงุฏู.

---

### **5. ููู ูููููุฐ ููู ุตูุฑุฉุ**
- **ุงูุทุฑููุฉ**: ุงุณุชุฎุฏุงู ุซุบุฑุงุช ูุซู **ImageTragick** ุฃู ุฅุถุงูุฉ ููุฏ PHP ุฏุงุฎู ุจูุงูุงุช EXIF.
- **ุงููุซุงู**:  
  ```php
  // ุตูุฑุฉ ุชุญุชูู ููุฏ PHP ูู ูุตู EXIF
  <?php system($_GET['cmd']); ?>
  ```
  ุฃู ุงุณุชุฎุฏุงู `.jpg.php` ุฅุฐุง ูู ูุชู ุงูุชุญูู ูู ุงูุงูุชุฏุงุฏ ุจุดูู ุตุญูุญ.

---

### **6. ููุงุฐุง Path Traversal ุตุงูุชุ**
- **ุงูุณุจุจ**: ูุง ูุธูุฑ ุฃุฎุทุงุก ูุงุถุญุฉุ ููุท ููุฑุฃ ูููุงุช ูุธุงู ุบูุฑ ูุตุฑุญ ุจูุง.
- **ุงููุซุงู**:  
  ```
  download.php?file=../../../../etc/passwd
  ```
  **ุงููุชูุฌุฉ**: ุณุฑูุฉ ูููุงุช ุญุณุงุณุฉ ุฏูู ุชูุจูู.

---

### **7. ููุงุฐุง realpath ูููุ**
- **ุงูุณุจุจ**: ูุญูู ุงููุณุงุฑ ุงููุณุจู ุฅูู ูุณุงุฑ ูุทูู ููุฒูู `../` ููุนุฑูุฉ ุงููุณุงุฑ ุงูุญูููู.
- **ุงูููุงุฑูุฉ**:  
  ```php
  // ุจุฏูู realpath (ุฎุทุฑ)
  $file = $_GET['file']; // ../../../etc/passwd
  include($file); // ููุฑุฃ ููู ุงููุธุงู
  
  // ูุน realpath (ุขูู)
  $realPath = realpath($file);
  if (strpos($realPath, '/safe/dir/') !== 0) {
      die('ุบูุฑ ูุตุฑุญ');
  }
  ```

---

### **8. ููู ุชูุณุชุบู ุงูุซูุฉ ุจุงููุณุชุฎุฏูุ**
- **ูู CSRF**: ุซูุฉ ุงููููุน ุจุฃู ุงููุณุชุฎุฏู ุงููุณุฌู ูู ูุฑุณู ุทูุจุงุช ุถุงุฑุฉ.
- **ูู XSS**: ุซูุฉ ุงููุณุชุฎุฏู ุจุฃู ุงููุญุชูู ูู ุงููููุน ุดุฑุนู.
- **ูุซุงู**: ุฒุฑ "ุงุญุตู ุนูู ูุฏูุฉ" ูุฎูู ูููุฐ ุชุญููู ุฃููุงู.

---

### **9. ููุงุฐุง SameSite ูุนูุงูุ**
- **ุงูุณุจุจ**: ูููุน ุงููุชุตูุญ ูู ุฅุฑุณุงู ุงูููููุฒ ูู ุทูุจุงุช ูู ููุงูุน ุฃุฎุฑู.
- **ุงูุชูููุฐ**:  
  ```php
  setcookie('session', $value, [
      'samesite' => 'Strict',
      'secure' => true,
      'httponly' => true
  ]);
  ```
  **ุงูุฃุซุฑ**: ูููุน ูุนุธู ูุฌูุงุช CSRF.

---

### **10. ููู ูุคุฏู ุฑูุน ููู ูุงุฎุชุฑุงู ูุงููุ**
- **ุงูุฎุทูุงุช**:
  1. ุฑูุน ููู `shell.php` ูุญุชูู ุนูู:  
     ```php
     <?php system($_GET['cmd']); ?>
     ```
  2. ุงููุตูู ููู shell ุนุจุฑ:  
     ```
     http://site.com/uploads/shell.php?cmd=id
     ```
  3. ุงูุชุตุนูุฏ ููุชุญูู ุงููุงูู ูู ุงูุฎุงุฏู.

---

## ๐งช ุฃุณุฆูุฉ (ูุงุฐุง ููุ)

### **1. ูุงุฐุง ูู ูู ุชุณุชุฎุฏู CSRF Tokenุ**
- **ุงููุชูุฌุฉ**: ุฃู ูููุน ุขุฎุฑ ููููู ุชูููุฐ ุทูุจุงุช ููุงุจุฉ ุนู ุงููุณุชุฎุฏู ุงููุณุฌู.
- **ุงููุฌูู**:  
  ```html
  <form action="https://site.com/delete-account" method="POST">
    <button>ุงุญุตู ุนูู ูุฏูุฉ ูุฌุงููุฉ!</button>
  </form>
  ```

---

### **2. ูุงุฐุง ูู ูุจูุช ุฃู ุงูุชุฏุงุฏุ**
- **ุงููุดููุฉ**: ุฑูุน ูููุงุช ุชูููุฐูุฉ ูุซู `.php`, `.phtml`, `.htaccess`.
- **ุงููุซุงู**: `.htaccess` ูุชุดุบูู PHP ูู ูููุงุช `.jpg`:  
  ```
  AddType application/x-httpd-php .jpg
  ```

---

### **3. ูุงุฐุง ูู ุญูุธุช ุงูููู ุจุงุณูู ุงูุฃุตููุ**
- **ุงูุฎุทุฑ**: ุงุณุชุจุฏุงู ุงููููุงุช ุฃู ุชูููุฐ Overwrite Attack.
- **ุงููุซุงู**: ุฑูุน `config.php` ููุณุชุจุฏู ููู ุงูุฅุนุฏุงุฏุงุช.

---

### **4. ูุงุฐุง ูู ุชุฌุงููุช realpathุ**
- **ุงูุซุบุฑุฉ**: Path Traversal ููุฑุงุกุฉ ูููุงุช ูุธุงู.
- **ุงููุฌูู**:  
  ```
  ?file=../../../../../etc/passwd
  ```

---

### **5. ูุงุฐุง ูู ูุถุนุช uploads ุฏุงุฎู public_htmlุ**
- **ุงูุฎุทุฑ**: ุงููุตูู ุงููุจุงุดุฑ ูููููุงุช ุงููุฑููุนุฉ.
- **ุงูุญู**: ูุถุน ุงููุฌูุฏ ุฎุงุฑุฌ ุงููุณุงุฑ ุงูุนุงู ูุน script ููุชุญููู ุงูุขูู.

---

## โ๏ธ ุชูุฑูู ุชุทุจููู (ูุฎุชุจุฑ ุงูุฌุฒุก ุงูุซุงูู)

### **ูููุฐุฌ ุชุนุฏูู ุจูุงูุงุช (CSRF)**
```php
// ููุฏ ุถุนูู
<form action="/update-profile.php" method="POST">
  <input name="email" value="user@example.com">
  <button>ุชุญุฏูุซ</button>
</form>
```

**ุชูููุฐ CSRF**:  
```html
<!-- ุตูุญุฉ ูุฌูููุฉ -->
<body onload="document.forms[0].submit()">
  <form action="https://victim.com/update-profile" method="POST">
    <input type="hidden" name="email" value="hacker@evil.com">
  </form>
</body>
```

**ุฅุถุงูุฉ Token**:  
```php
// ุชูููุฏ ุงูุชูููู
session_start();
$token = bin2hex(random_bytes(32));
$_SESSION['csrf_token'] = $token;

// ูู ุงููููุฐุฌ
<input type="hidden" name="csrf_token" value="<?= $token ?>">

// ุงูุชุญูู
if (!hash_equals($_SESSION['csrf_token'], $_POST['csrf_token'])) {
    die('ุทูุจ ุบูุฑ ุดุฑุนู');
}
```

---

### **ูููุฐุฌ ุฑูุน ููู**
```php
// ููุฏ ุถุนูู
$file = $_FILES['file'];
move_uploaded_file($file['tmp_name'], 'uploads/' . $file['name']);
```

**ุงุณุชุบูุงู ุฑูุน ููู**:  
1. ุฑูุน `shell.php` ูุน ุงููุญุชูู:  
   ```php
   <?php system($_GET['cmd']); ?>
   ```
2. ุงููุตูู: `http://site.com/uploads/shell.php?cmd=ls`

**ุฅุตูุงุญู ุจุงูู whitelist**:  
```php
$allowed = ['jpg', 'png', 'pdf'];
$ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));

if (!in_array($ext, $allowed)) {
    die('ููุน ุงูููู ุบูุฑ ูุณููุญ');
}

// ุชุบููุฑ ุงูุงุณู
$newName = uniqid() . '.' . $ext;
move_uploaded_file($file['tmp_name'], 'uploads/' . $newName);
```

---

### **ุตูุญุฉ ุชุญููู ูููุงุช (Path Traversal)**
```php
// ููุฏ ุถุนูู
$file = $_GET['file'];
readfile('uploads/' . $file);
```

**ุงุณุชุบูุงู Path Traversal**:  
```
download.php?file=../../../../etc/passwd
```

**ููุนู ุจุงุณุชุฎุฏุงู realpath**:  
```php
$baseDir = realpath('uploads/');
$filePath = realpath('uploads/' . $_GET['file']);

if ($filePath === false || strpos($filePath, $baseDir) !== 0) {
    die('ููู ุบูุฑ ููุฌูุฏ');
}

header('Content-Type: ' . mime_content_type($filePath));
readfile($filePath);
```

---

## โ ุงูุฎูุงุตุฉ
1. **CSRF Token** ุถุฑูุฑู ููู ุทูุจ ูุบูุฑ ุจูุงูุงุช.
2. **SameSite Cookie** ุญูุงูุฉ ุฅุถุงููุฉ ุถุฏ CSRF.
3. **Whitelist** ููุงูุชุฏุงุฏุงุช ูู ุฑูุน ุงููููุงุช (ููุณ blacklist).
4. **ุชุบููุฑ ุฃุณูุงุก ุงููููุงุช** ุงููุฑููุนุฉ ุนุดูุงุฆููุง.
5. **realpath()** ููุชุญูู ูู ุงููุณุงุฑุงุช.
6. **ุนุฒู ูุฌูุฏ ุงูุฑูุน** ุฎุงุฑุฌ ุงููุณุงุฑ ุงูุนุงู.
7. **ุชุนุทูู ุชูููุฐ PHP** ูู ูุฌูุฏุงุช ุงูุฑูุน:  
   ```apache
   <Directory /var/www/uploads>
     php_flag engine off
   </Directory>
   ```