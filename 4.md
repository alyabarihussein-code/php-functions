
## ูุน ุฃูุซูุฉ ุนูููุฉ

---

### **1. ููุงุฐุง ุชูุนุฏ ุชุทุจููุงุช ุงูููุจ ุฃูุซุฑ ุนุฑุถุฉ ูููุฌูู ูู ุชุทุจููุงุช ุณุทุญ ุงูููุชุจุ**
- **ุงูุณุจุจ ุงูุฑุฆูุณู**: ุฅุชุงุญุชูุง ุนูู ุงูุฅูุชุฑูุช ููุฌููุนุ ุจูุง ูู ุฐูู ุงูููุงุฌููู.
- **ุงูููุงุฑูุฉ**:
  
  | **ุชุทุจููุงุช ุงูููุจ** | **ุชุทุจููุงุช ุณุทุญ ุงูููุชุจ** |
  |-------------------|------------------------|
  | ูุชุงุญุฉ ุนุจุฑ ุงูุฅูุชุฑูุช | ุชุนูู ูุญููุงู |
  | ุงูุฎุงุฏู ูุนุฑุถ ูููุฌูู ุงููุจุงุดุฑ | ูุญุชุงุฌ ูุตูู ูุงุฏู ุฃู ุงุฎุชุฑุงู ุงูุดุจูุฉ |
  | ูููู ุงุฎุชุจุงุฑูุง ุจุณูููุฉ ุนุจุฑ ุงููุชุตูุญ | ุชุญุชุงุฌ ุชูุตูุจ ูุชุดุบูู |
  
- **ุงููุซุงู**: ูููุน ุฅููุชุฑููู ูููู ูุฃู ุดุฎุต ูู ุงูุนุงูู ูุญุงููุฉ ุงุฎุชุฑุงููุ ุจูููุง ุจุฑูุงูุฌ ุนูู ุฌูุงุฒู ูุญุชุงุฌ ุงูููุงุฌู ูููุตูู ูุดุจูุชู ุฃููุงู.

---

### **2. ููุงุฐุง ูุง ูููู ุฌุฏุงุฑ ุงูุญูุงูุฉ ูุญูุงูุฉ ุงูุชุทุจููุ**
- **ุงูุณุจุจ**: ุฌุฏุงุฑ ุงูุญูุงูุฉ ูุญูู ุงูุดุจูุฉ ูุงูููุงูุฐุ ูููู ูุง ูููู ููุทู ุงูุชุทุจูู.
- **ุงููุดููุฉ**: ุงููุฌูุงุช ุนูู ูุณุชูู ุงูุชุทุจูู ุชูุฑ ุนุจุฑ ุงูููุงูุฐ ุงููุณููุญุฉ (80ุ 443).
- **ุงููุซุงู**:
  ```
  # ุฌุฏุงุฑ ุงูุญูุงูุฉ ูุณูุญ ุจู HTTP/HTTPS
  # ููู ุงูููุงุฌู ูุฑุณู:
  POST /login.php
  username=admin&password=' OR '1'='1
  
  # ูุฐู ูุฌูุฉ SQL Injection ุชูุฑ ุนุจุฑ HTTPS ุงูุนุงุฏู
  # ุฌุฏุงุฑ ุงูุญูุงูุฉ ูุง ูุณุชุทูุน ุงูุชุดุงููุง
  ```

---

### **3. ููู ูุคุซุฑ ุฎุทุฃ ููุทูู ุตุบูุฑ ุนูู ุฃูุงู ุงููุธุงู ุจุงููุงููุ**
- **ูุจุฏุฃ ุงูุณูุณูุฉ**: "ุฃุถุนู ุญููุฉ ูู ุงูุณูุณุฉ ุชุญุฏุฏ ููุชูุง"
- **ุงููุซุงู**:
  ```php
  // ุฎุทุฃ ููุทูู: ุงูุชุญูู ูู ุงูุตูุงุญูุฉ ูู ุงููุงุฌูุฉ ููุท
  if ($user->isAdmin) {
      echo '<button id="deleteAll">ุญุฐู ูู ุงูุจูุงูุงุช</button>';
  }
  // ููู ุงูุชุญูู ุบูุฑ ููุฌูุฏ ูู API!
  
  // ุงูููุงุฌู ูุชุฌุงูุฒ ุงููุงุฌูุฉ ููุฑุณู:
  DELETE /api/users/all
  // ููููุฐ ุงูุฃูุฑ ุฏูู ุชุญูู!
  ```

---

### **4. ููุงุฐุง ููุนุฏ ุงูุชุตููู ูุฑุญูุฉ ุฃูููุฉ ูุจู ุฃู ุชููู ุจุฑูุฌูุฉุ**
- **ุงููุจุฏุฃ**: "ูู ุงูุตุนุจ ุฅุถุงูุฉ ุงูุฃูุงู ูุงุญูุงูุ ูุฌุจ ุชุตูููู ูู ุงูุจุฏุงูุฉ"
- **ูุซุงู ุชุตููู ุฎุงุทุฆ**: ุงูุณูุงุญ ูููุณุชุฎุฏู ุจุชุญุฏูุฏ ุณุนุฑ ุงูููุชุฌ.
- **ูุซุงู ุชุตููู ุตุญูุญ**: ุงูุณุนุฑ ุซุงุจุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุงููุณุชุฎุฏู ูุฎุชุงุฑ ุงููููุฉ ููุท.
- **ุงููุฑู**: ุญุชู ูุน ููุฏ ุขููุ ุงูุชุตููู ุงูุฎุงุทุฆ ูุฎูู ุซุบุฑุงุช.

---

### **5. ูุง ุงููุฑู ุจูู "Bug" ู "Vulnerability"ุ**
| **Bug** | **Vulnerability** |
|---------|-------------------|
| ุฎุทุฃ ูู ุงูููุฏ | ุซุบุฑุฉ ุฃูููุฉ |
| ูุฏ ูุณุจุจ ุฎููุงู ูุธูููุงู | ูุณุชุบูู ุงูููุงุฌู ูุงุฎุชุฑุงู ุงููุธุงู |
| ูุซุงู: ุฒุฑ ูุง ูุนูู | ูุซุงู: SQL Injection |
| ุงูุชุฃุซูุฑ: ุนูู ุงููุณุชุฎุฏู | ุงูุชุฃุซูุฑ: ุนูู ุงููุธุงู ุจุงููุงูู |

**ุงููุซุงู**: ุฎุทุฃ ูู ุญุณุงุจ ุงูุณุนุฑ (Bug) โ ุซุบุฑุฉ ุชุณูุญ ุจุชุนุฏูู ุงูุณุนุฑ (Vulnerability).

---

### **6. ููุงุฐุง ูุง ูุฌุจ ุงูุชุฑุงุถ ุญุณู ููุฉ ุงููุณุชุฎุฏูุ**
- **ุงููุจุฏุฃ**: "ุงูุชุฑุถ ุฃู ูู ูุฏุฎูุงุช ุงููุณุชุฎุฏู ุฎุจูุซุฉ ุญุชู ุชุซุจุช ุงูุนูุณ"
- **ุงูุฃุณุจุงุจ**:
  1. ูุฏ ูููู ุงููุณุชุฎุฏู ููุงุฌูุงู ูุชุฎููุงู
  2. ูุฏ ูููู ุฌูุงุฒ ุงููุณุชุฎุฏู ูุตุงุจุงู
  3. ูุฏ ูููู ุงููุณุชุฎุฏู ุบูุฑ ูุฏุฑู (ูุถุบุท ุนูู ุฑูุงุจุท ุฎุจูุซุฉ)
- **ุงูุชุทุจูู**: ุชุญูู ูู ุฌููุน ุงููุฏุฎูุงุชุ ุงูุชุฑุงุถูุงู.

---

### **7. ููู ุชุคุซุฑ ุณุฑุนุฉ ุงูุชุทููุฑ ุนูู ูุณุชูู ุงูุฃูุงูุ**
- **ุงูููุงุถูุฉ**: ุงูุณุฑุนุฉ โโ ุงูุฌูุฏุฉ โโ ุงูุฃูุงู
- **ุงููุฎุงุทุฑ ุนูุฏ ุงูุฅุณุฑุงุน**:
  1. ุนุฏู ุงุฎุชุจุงุฑ ุงููุฏุฎูุงุช
  2. ูุณุฎ ููุฏ ุบูุฑ ุขูู
  3. ุชุฌุงูู ุชุญุฏูุซุงุช ุงูุฃูุงู
  4. ุฅููุงู ูุฑุงุฌุนุฉ ุงูุฃููุงุฏ
- **ุงูุญู**: DevSecOps - ุฏูุฌ ุงูุฃูุงู ูู ุฎุทูุงุช ุงูุชุทููุฑ.

---

### **8. ููุงุฐุง ุชูุนุฏ OWASP ูุฑุฌุนูุง ูููุณ ูุงููููุงุ**
- **OWASP**: Open Web Application Security Project
- **ูุฑุฌุน**: ููุฏู ุฃูุถู ุงูููุงุฑุณุงุช ูุงูุชูุตูุงุช
- **ููุณ ูุงูููุงู**: ูุฃูู:
  1. ูุง ููุทุจู ุนูู ุฌููุน ุงูุญุงูุงุช
  2. ูุชุบูุฑ ูุน ุงูููุช (ูุชุฌุฏุฏ ูู 3-4 ุณููุงุช)
  3. ูุญุชุงุฌ ุชูููู ุญุณุจ ุงูุชุทุจูู
- **ุงูุงุณุชุฎุฏุงู ุงูุตุญูุญ**: ูุฏูููุ ููุณ ููุงุฆูุฉ ููุงู.

---

### **9. ูุง ุงูุฎุทุฑ ูู ุงูุงุนุชูุงุฏ ุนูู ุงูุชุญูู ูู ุฌูุฉ ุงูุนููู ููุทุ**
- **ุงููุดููุฉ**: ูููู ุชุฌุงูุฒ JavaScript ุจุณูููุฉ.
- **ุงููุซุงู**:
  ```javascript
  // client-side validation
  if (password.length < 8) {
      alert("ูููุฉ ุงููุฑูุฑ ูุตูุฑุฉ");
      return false;
  }
  ```
  **ุงูุชุฌุงูุฒ**: ุฅุฑุณุงู ุงูุทูุจ ูุจุงุดุฑุฉ ุนุจุฑ curl ุฃู Postman:
  ```bash
  curl -X POST https://site.com/register -d "password=123"
  ```

---

### **10. ููู ุชุบููุฑ ุนูููุฉ ุงูููุงุฌู ุทุฑููุฉ ูุชุงุจุชู ููููุฏุ**
- **ุงูุชูููุฑ ููุฏุงูุน**: "ููู ุฃุฌุนู ุงููุธุงู ูุนููุ"
- **ุงูุชูููุฑ ูููุงุฌู**: "ููู ูููููู ูุณุฑ ูุฐุง ุงููุธุงูุ"
- **ุงูุฃุณุฆูุฉ ุงูุชู ูุฌุจ ุฃู ุชุณุฃููุง**:
  1. ูุงุฐุง ูู ุฃุฏุฎู ุงููุณุชุฎุฏู ููููู ุญุฑูุ
  2. ูุงุฐุง ูู ุญุงูู ุงููุตูู ูุจูุงูุงุช ุงูุขุฎุฑููุ
  3. ูุงุฐุง ูู ุนุฏู ุงูุทูุจ ูุจู ุฅุฑุณุงููุ
  4. ูุงุฐุง ูู ุงุณุชุฎุฏู ุฃุฏุงุฉ ุฃูุชููุงุชูููุฉุ

---

## ๐งช ุฃุณุฆูุฉ (ูุงุฐุง ููุ)

### **1. ูุงุฐุง ูู ุฃุฑุณู ุงููุณุชุฎุฏู ูููุฉ ูู ุชุชููุนูุงุ**
- **ุงููุซุงู**: ุญูู ุงูุนูุฑุ ุชูุชุธุฑ ุฑููุ ููู ุงููุณุชุฎุฏู ูุฑุณู:
  ```
  age=<script>alert('hacked')</script>
  ```
- **ุงูุญู**: Validation + Sanitization + Encoding
  ```php
  $age = (int)$_POST['age']; // Cast ุฅูู integer
  if ($age < 0 || $age > 150) { // Validation
      die("ุนูุฑ ุบูุฑ ุตุงูุญ");
  }
  ```

### **2. ูุงุฐุง ูู ุชุฌุงูุฒ ุงููุงุฌูุฉ ูุฃุฑุณู ุงูุทูุจ ูุจุงุดุฑุฉุ**
- **ุงููุซุงู**: ูุธุงู ูุฎูู ุฒุฑ "ุญุฐู" ุนู ุงููุณุชุฎุฏู ุงูุนุงุฏูุ ููู ุงูููุงุฌู ูุฑุณู:
  ```bash
  curl -X DELETE https://site.com/api/users/123
  ```
- **ุงูุญู**: ุงูุชุญูู ูู ุงูุฎุงุฏู ุฏุงุฆูุงู
  ```php
  // ูู API controller
  if (!$user->canDelete()) { // ุงูุชุญูู ูู ุงูุฎุงุฏู
      return response()->json(['error' => 'ุบูุฑ ูุตุฑุญ'], 403);
  }
  ```

### **3. ูุงุฐุง ูู ูุฌุญ ูู ุชุนุฏูู Sessionุ**
- **ุงููุฌูู**: Session Hijacking ุฃู Session Fixation
- **ุงููุซุงู**: ุณุฑูุฉ Session ID ุฃู ุชุญุฏูุฏู ูุณุจูุงู
- **ุงูุญู**: ุฅุนุฏุงุฏุงุช ุขููุฉ ููุฌูุณุฉ
  ```php
  session_start([
      'cookie_httponly' => true, // ูุง ูููู ุงููุตูู ุนุจุฑ JavaScript
      'cookie_secure' => true, // HTTPS ููุท
      'cookie_samesite' => 'Strict' // ููุน CSRF
  ]);
  session_regenerate_id(true); // ุชุบููุฑ Session ID ุจุนุฏ ุงูุฏุฎูู
  ```

### **4. ูุงุฐุง ูู ุงุนุชูุฏุช ุนูู JavaScript ููุท ูู ุงูุชุญููุ**
- **ุงููุดููุฉ**: ูููู ุชุนุทูู JavaScript ุฃู ุชุนุฏููู
- **ุงููุซุงู**: 
  ```javascript
  // ูููู ุชุนุทููู ูู ุงููุชุตูุญ
  // ุฃู ุงูุชุนุฏูู ุนููู ุนุจุฑ ุฃุฏูุงุช ุงููุทูุฑ
  ```
- **ุงูุญู**: ุงูุชุญูู ูู ุงูุฎุงุฏู ุฃููุงู ูุฃุฎูุฑุงูุ JavaScript ููุชุญุณูู ููุท

### **5. ูุงุฐุง ูู ูู ุชุณุฌู ุฃู ูุดุงุท ูู ุงููุธุงูุ**
- **ุงููุดููุฉ**: ูุง ูููู ุชุชุจุน ุงููุฌูุงุช ุฃู ุงููุดุงูู
- **ุงููุชูุฌุฉ**: ุงุฎุชุฑุงู ูุงุฌุญ ุฏูู ุงูุชุดุงู
- **ุงูุญู**: ุณุฌูุงุช ุดุงููุฉ
  ```php
  error_log("[" . date('Y-m-d H:i:s') . "] " . 
            $_SERVER['REMOTE_ADDR'] . " - " . 
            $_SERVER['REQUEST_URI']);
  ```

### **6. ูุงุฐุง ูู ูู ุชุถุน ุฃู ูููุฏ ุนูู ุงูุตูุงุญูุงุชุ**
- **ุงููุงุฑุซุฉ**: ุฃู ูุณุชุฎุฏู ููููู ูุนู ุฃู ุดูุก
- **ุงููุซุงู**: ูุณุชุฎุฏู ุนุงุฏู ูุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุงูุญู**: ูุจุฏุฃ ุฃูู ุตูุงุญูุงุช (Least Privilege)
  ```sql
  -- ูุงุนุฏุฉ ุจูุงูุงุช: ูุณุชุฎุฏู ุงูุชุทุจูู ููุณ ูู ุตูุงุญูุงุช root
  GRANT SELECT, INSERT, UPDATE ON app_db.* TO 'app_user'@'localhost';
  -- ูุง DELETEุ ูุง DROPุ ูุง ALTER
  ```

---

## โ๏ธ ุชูุฑูู ุชุทุจููู (ุชูููุฏู)

### **ูููุฐุฌ ุชุณุฌูู ุฏุฎูู ุจุณูุท:**
```php
// login.php - ุงูุฅุตุฏุงุฑ ุงูุถุนูู
$username = $_POST['username'];
$password = $_POST['password'];

$sql = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
$result = mysqli_query($conn, $sql);

if (mysqli_num_rows($result) > 0) {
    echo "ูุฑุญุจุงู $username!";
    $_SESSION['user'] = $username;
} else {
    echo "ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
}
```

---

### **1. ุชุญุฏูุฏ 5 ูุฎุงุทุฑ ุฃูููุฉ ูุญุชููุฉ**

```yaml
1. SQL Injection:
   - ุงููุตู: ุงูููุงุฌู ูุญูู ุฃูุงูุฑ SQL ูู ุญูู ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ
   - ุงููุซุงู: username = admin' OR '1'='1
   - ุงูุชุฃุซูุฑ: ุฏุฎูู ุจุฏูู ูููุฉ ูุฑูุฑุ ุฃู ุณุฑูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

2. No Password Hashing:
   - ุงููุตู: ูููุงุช ุงููุฑูุฑ ูุฎุฒูุฉ ููุต ุตุฑูุญ
   - ุงููุซุงู: ูู ุณูุฑูุช ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุฌููุน ูููุงุช ุงููุฑูุฑ ููุดููุฉ
   - ุงูุชุฃุซูุฑ: ุงุฎุชุฑุงู ุฌููุน ุงูุญุณุงุจุงุช

3. Information Disclosure:
   - ุงููุตู: ุฑุณุงูุฉ ุฎุทุฃ ุชุญุฏุฏ ุฃู ุฌุฒุก ุฎุงุทุฆ
   - ุงููุซุงู: "ุงุณู ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏ" vs "ูููุฉ ุงููุฑูุฑ ุฎุงุทุฆุฉ"
   - ุงูุชุฃุซูุฑ: ุงูููุงุฌู ูุนุฑู ุฃู ุญุณุงุจุงุช ููุฌูุฏุฉ

4. No Rate Limiting:
   - ุงููุตู: ูุง ุญุฏูุฏ ูุนุฏุฏ ูุญุงููุงุช ุงูุฏุฎูู
   - ุงููุซุงู: ูุฌูู Brute Force - 10000 ูุญุงููุฉ ูู ุฏูููุฉ
   - ุงูุชุฃุซูุฑ: ุชุฎููู ูููุงุช ุงููุฑูุฑ

5. Session Management Issues:
   - ุงููุตู: Session ID ุบูุฑ ุขููุ ูููู ุณุฑูุชู
   - ุงููุซุงู: Session Hijacking ุนุจุฑ XSS
   - ุงูุชุฃุซูุฑ: ุงูุฏุฎูู ุจุญุณุงุจ ุงูุถุญูุฉ ุฏูู ูููุฉ ูุฑูุฑ
```

---

### **2. ุงูุชุฑุงุญ ุญู ูุจุฏุฆู ููู ุฎุทุฑ**

```yaml
1. SQL Injection:
   - ุงูุญู: ุงุณุชุฎุฏุงู Prepared Statements
   - ุงูุชูููุฐ:
     $stmt = $conn->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
     $stmt->bind_param("ss", $username, $hashedPassword);
     $stmt->execute();

2. No Password Hashing:
   - ุงูุญู: ุงุณุชุฎุฏุงู password_hash() ู password_verify()
   - ุงูุชูููุฐ:
     // ุนูุฏ ุงูุชุณุฌูู:
     $hashed = password_hash($password, PASSWORD_BCRYPT);
     // ุนูุฏ ุงูุฏุฎูู:
     if (password_verify($inputPassword, $storedHash)) { ... }

3. Information Disclosure:
   - ุงูุญู: ุฑุณุงุฆู ุฎุทุฃ ุนุงูุฉ
   - ุงูุชูููุฐ:
     echo "ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ"; // ููุณ ุงูุฑุณุงูุฉ ุฏุงุฆูุงู

4. No Rate Limiting:
   - ุงูุญู: ุชุญุฏูุฏ ุนุฏุฏ ุงููุญุงููุงุช ููู ุนููุงู IP
   - ุงูุชูููุฐ:
     if (failed_attempts($ip) > 5) {
         sleep(2); // ุชุฃุฎูุฑ
         echo "ุญุงูู ูุฑุฉ ุฃุฎุฑู ุจุนุฏ ูููู";
     }

5. Session Management:
   - ุงูุญู: ุฅุนุฏุงุฏุงุช ุขููุฉ ููุฌูุณุฉ
   - ุงูุชูููุฐ:
     session_start([
         'cookie_httponly' => true,
         'cookie_secure' => true,
         'cookie_samesite' => 'Strict'
     ]);
     session_regenerate_id(true);
```

---

### **3. ุชุญุฏูุฏ ุงููุฑุญูุฉ ุงูุชู ูุฌุจ ูุนุงูุฌุฉ ุงูุฎุทุฑ ูููุง**

```yaml
1. SQL Injection:
   - ุงููุฑุญูุฉ: ุงูุชุตููู (Design)
   - ุงูุณุจุจ: ูุฌุจ ุงุฎุชูุงุฑ ุงุณุชุฎุฏุงู Prepared Statements ูุฌุฒุก ูู ุชุตููู ุงููุธุงู
   
2. No Password Hashing:
   - ุงููุฑุญูุฉ: ุงูุชุตููู (Design)
   - ุงูุณุจุจ: ูุธุงู Hashing ูุฌุจ ุฃู ูููู ุฌุฒุกุงู ูู ุชุตููู ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู

3. Information Disclosure:
   - ุงููุฑุญูุฉ: ุงูุชุตููู (Design) ูุงูููุฏ (Code)
   - ุงูุณุจุจ: ุณูุงุณุฉ ุงูุฑุณุงุฆู ูุฌุจ ุชุตููููุงุ ุซู ุชุทุจูููุง ูู ุงูููุฏ

4. No Rate Limiting:
   - ุงููุฑุญูุฉ: ุงูุชุตููู (Design)
   - ุงูุณุจุจ: ูุฌุจ ุชุตููู ุขููุฉ Rate Limiting ูุจู ูุชุงุจุฉ ุงูููุฏ

5. Session Management:
   - ุงููุฑุญูุฉ: ุงูุชุตููู (Design) ูุงูููุฏ (Code)
   - ุงูุณุจุจ: ุฅุณุชุฑุงุชูุฌูุฉ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุชุตูููุ ูุงูุฅุนุฏุงุฏุงุช ููุฏ
```

---

### **4. ุงูุฅุตุฏุงุฑ ุงููุญุณูู ูููููุฐุฌ**

```php
// login.php - ุงูุฅุตุฏุงุฑ ุงูุขูู
class SecureLogin {
    private $conn;
    private $maxAttempts = 5;
    private $lockTime = 900; // 15 ุฏูููุฉ
    
    public function __construct($dbConnection) {
        $this->conn = $dbConnection;
    }
    
    public function login($username, $password) {
        // 1. ุงูุชุญูู ูู Rate Limiting ุฃููุงู
        if ($this->isLocked($username)) {
            return "ุชู ุชุนููู ุงูุญุณุงุจ ูุคูุชุงู. ุญุงูู ูุฑุฉ ุฃุฎุฑู ูุงุญูุงู.";
        }
        
        // 2. ุชูุธูู ุงููุฏุฎูุงุช
        $username = $this->sanitizeInput($username);
        $password = $this->sanitizeInput($password);
        
        // 3. ุงูุจุญุซ ุนู ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู Prepared Statement
        $stmt = $this->conn->prepare("SELECT id, username, password_hash FROM users WHERE username = ?");
        $stmt->bind_param("s", $username);
        $stmt->execute();
        $result = $stmt->get_result();
        
        // 4. ููุณ ุงูุฑุณุงูุฉ ุณูุงุก ูุงู ุงููุณุชุฎุฏู ููุฌูุฏุงู ุฃู ูุง
        if ($result->num_rows === 0) {
            $this->recordFailedAttempt($username);
            return "ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
        }
        
        $user = $result->fetch_assoc();
        
        // 5. ุงูุชุญูู ูู ูููุฉ ุงููุฑูุฑ ุจุงุณุชุฎุฏุงู password_verify
        if (!password_verify($password, $user['password_hash'])) {
            $this->recordFailedAttempt($username);
            return "ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
        }
        
        // 6. ุฅุฐุง ูุตู ููุงุ ุงูุฏุฎูู ูุงุฌุญ
        $this->clearFailedAttempts($username);
        $this->startSecureSession($user);
        
        // 7. ุชุณุฌูู ุงูุฏุฎูู ุงููุงุฌุญ
        $this->logLogin($user['id'], true);
        
        return "ูุฑุญุจุงู " . htmlspecialchars($user['username']) . "!";
    }
    
    private function isLocked($username) {
        $stmt = $this->conn->prepare("SELECT lock_until FROM login_attempts WHERE username = ? AND lock_until > ?");
        $currentTime = time();
        $stmt->bind_param("si", $username, $currentTime);
        $stmt->execute();
        
        return $stmt->get_result()->num_rows > 0;
    }
    
    private function recordFailedAttempt($username) {
        $ip = $_SERVER['REMOTE_ADDR'];
        $now = time();
        
        // ุนุฏ ุงููุญุงููุงุช ูู ุขุฎุฑ ุณุงุนุฉ
        $stmt = $this->conn->prepare("
            SELECT COUNT(*) as attempts 
            FROM login_attempts 
            WHERE (username = ? OR ip = ?) 
            AND timestamp > ?
        ");
        $oneHourAgo = $now - 3600;
        $stmt->bind_param("ssi", $username, $ip, $oneHourAgo);
        $stmt->execute();
        
        $attempts = $stmt->get_result()->fetch_assoc()['attempts'];
        
        // ุฅุฐุง ุชุฌุงูุฒ ุงูุญุฏุ ุญุธุฑ ูุคูุช
        if ($attempts >= $this->maxAttempts) {
            $lockUntil = $now + $this->lockTime;
            $stmt = $this->conn->prepare("
                INSERT INTO login_attempts (username, ip, lock_until, timestamp) 
                VALUES (?, ?, ?, ?)
            ");
            $stmt->bind_param("ssii", $username, $ip, $lockUntil, $now);
            $stmt->execute();
        }
        
        $this->logLogin(null, false, $username);
    }
    
    private function startSecureSession($user) {
        session_start([
            'cookie_httponly' => true,
            'cookie_secure' => true, // ูุนูู ููุท ูุน HTTPS
            'cookie_samesite' => 'Strict',
            'use_strict_mode' => true
        ]);
        
        // ุฅูุดุงุก Session ID ุฌุฏูุฏ
        session_regenerate_id(true);
        
        // ุชุฎุฒูู ุจูุงูุงุช ุงูุฌูุณุฉ
        $_SESSION['user_id'] = $user['id'];
        $_SESSION['username'] = $user['username'];
        $_SESSION['login_time'] = time();
        $_SESSION['ip'] = $_SERVER['REMOTE_ADDR'];
        $_SESSION['user_agent'] = $_SERVER['HTTP_USER_AGENT'];
        
        // ุฅุถุงูุฉ CSRF token
        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
    }
    
    private function sanitizeInput($input) {
        $input = trim($input);
        $input = stripslashes($input);
        $input = htmlspecialchars($input);
        return $input;
    }
    
    private function logLogin($userId, $success, $username = null) {
        $log = sprintf(
            "[%s] %s - IP: %s - User: %s - Success: %s",
            date('Y-m-d H:i:s'),
            $success ? 'LOGIN_SUCCESS' : 'LOGIN_FAILED',
            $_SERVER['REMOTE_ADDR'],
            $username ?? ($userId ? "ID:$userId" : 'unknown'),
            $success ? 'YES' : 'NO'
        );
        
        error_log($log);
    }
}

// ุงูุงุณุชุฎุฏุงู
$loginSystem = new SecureLogin($conn);
$message = $loginSystem->login($_POST['username'], $_POST['password']);
echo $message;
```

---

## โ ุงูุฎูุงุตุฉ

1. **ุงูุชุตููู ุฃููุงู**: ููุฑ ูู ุงูุฃูุงู ูุจู ูุชุงุจุฉ ุฃูู ุณุทุฑ ููุฏ.
2. **ูุง ุชุซู ูู ุงููุฏุฎูุงุช**: ุชุญููุ ูุธูุ ูุฑุจ.
3. **ุงูุฏูุงุน ูุชุนุฏุฏ ุงูุทุจูุงุช**: ูุง ุชุนุชูุฏ ุนูู ุญูุงูุฉ ูุงุญุฏุฉ.
4. **ุงูุชุณุฌูู ููู**: ุจุฏูู ุณุฌูุงุชุ ุฃูุช ุชุนูู ูู ุงูุธูุงู.
5. **ุงูุชุญุฏูุซ ุงููุณุชูุฑ**: ุงูุฃูุงู ููุณ ุนูููุฉ ููุฑุฉ ูุงุญุฏุฉ.

