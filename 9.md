
## ูุน ุฃูุซูุฉ ุนูููุฉ

---

### **1. ููุงุฐุง MD5 ุบูุฑ ุขููุ**
- **ุงูุณุจุจ**: MD5 ุณุฑูุน ุฌุฏุงู ููุงุฎุชุฑุงูุ ููู ุซุบุฑุงุช ุชุฌุนูู ุบูุฑ ุขูู ููุชุดููุฑ.
- **ุงูููุงุฑูุฉ**:
  - **MD5**: ูููู ุงุฎุชุฑุงูู ูู ุซูุงูู ุจุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุญุฏูุซุฉ.
  - **bcrypt/Argon2**: ูุตูู ุฎุตูุตุงู ููููุงุช ุงููุฑูุฑุ ุจุทูุก ููููู ุญุณุงุจูุงู.
- **ุงููุซุงู**:  
  ```php
  // ุบูุฑ ุขูู
  $hash = md5($password); // ุณูู ุงูุงุฎุชุฑุงู
  
  // ุขูู
  $hash = password_hash($password, PASSWORD_BCRYPT, ['cost' => 12]);
  ```

---

### **2. ููุงุฐุง ูุง ูุฎุจุฑ ุงููุณุชุฎุฏู ุฅู ูุงู ุงูุญุณุงุจ ููุฌูุฏูุงุ**
- **ุงูุณุจุจ**: ูููุน Information Disclosure ุงูุฐู ูุณุงุนุฏ ุงูููุงุฌููู.
- **ุงููุดููุฉ**: ูู ูููุง "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ููุฌูุฏ"ุ ูุนุฑู ุงูููุงุฌู ุฃู ุงูุญุณุงุจ ุบูุฑ ููุฌูุฏ.
- **ุงูุญู**: ุฑุณุงุฆู ููุญุฏุฉ:  
  ```php
  // ุฏุงุฆูุงู ููุณ ุงูุฑุณุงูุฉ
  echo "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
  
  // ุญุชู ูู ุงูุจุฑูุฏ ุตุญูุญ ููููุฉ ุงููุฑูุฑ ุฎุงุทุฆุฉ
  if (!user_exists($email) || !password_verify($password, $hash)) {
      return "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
  }
  ```

---

### **3. ููู ุชููุน ุณูุงุณุฉ ูููุฉ ุงููุฑูุฑ ุงูุงุฎุชุฑุงูุ**
- **ุดุฑูุท ูููุฉ ุงููุฑูุฑ ุงููููุฉ**:
  1. **ุงูุทูู**: 12 ุญุฑูุงู ุนูู ุงูุฃูู
  2. **ุงูุชุนููุฏ**: ุฃุญุฑู ูุจูุฑุฉุ ุตุบูุฑุฉุ ุฃุฑูุงูุ ุฑููุฒ
  3. **ุงูููุน**: ูุง ูููุงุช ุดุงุฆุนุฉุ ูุง ูุนูููุงุช ุดุฎุตูุฉ
  4. **ุงูุชุฌุฏูุฏ**: ุชุบููุฑ ุฏูุฑู (90 ูููุงู)
  5. **ุงูุชูุฑุงุฑ**: ูุง ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุขุฎุฑ 5 ูููุงุช
- **ุงูุชุญูู**:  
  ```php
  function validatePassword($password) {
      if (strlen($password) < 12) return false;
      if (!preg_match('/[A-Z]/', $password)) return false;
      if (!preg_match('/[a-z]/', $password)) return false;
      if (!preg_match('/[0-9]/', $password)) return false;
      if (!preg_match('/[^\w]/', $password)) return false;
      
      // ุงูุชุญูู ูู ุงููููุงุช ุงูุดุงุฆุนุฉ
      $common = ['password123', '12345678', 'qwerty', 'admin'];
      if (in_array(strtolower($password), $common)) return false;
      
      return true;
  }
  ```

---

### **4. ูุง ุงููุฑู ุจูู Authentication ูAuthorizationุ**
| **Authentication (ุงููุตุงุฏูุฉ)** | **Authorization (ุงูุตูุงุญูุงุช)** |
|-----------------------------|------------------------------|
| "ูู ุฃูุชุ" - ุฅุซุจุงุช ุงููููุฉ | "ูุง ุงูุฐู ููุณูุญ ูู ุจูุ" - ุชุญุฏูุฏ ุงูุตูุงุญูุงุช |
| ูุซุงู: ุชุณุฌูู ุงูุฏุฎูู | ูุซุงู: ุงููุตูู ููููุงุช ูุนููุฉ |
| ุฃุฏูุงุช: ูููุฉ ูุฑูุฑุ MFA | ุฃุฏูุงุช: RBACุ ACL |
- **ุงูุชุณูุณู**: Authentication ุฃููุงูุ ุซู Authorization.

---

### **5. ููุงุฐุง delay ูุนุงู ุถุฏ brute forceุ**
- **ุงููุจุฏุฃ**: ูุฌุนู ุงููุฌูู ุบูุฑ ุนููู ุจุณุจุจ ุงูููุช ุงูุทููู.
- **ุงูุญุณุงุจ**:  
  ```
  ุจุฏูู delay: 1000 ูุญุงููุฉ/ุซุงููุฉ = 36 ููููู ูุญุงููุฉ/10 ุณุงุนุงุช
  ูุน delay (2 ุซุงููุฉ): 0.5 ูุญุงููุฉ/ุซุงููุฉ = 1800 ูุญุงููุฉ/10 ุณุงุนุงุช
  ```
- **ุงูุชูููุฐ**:  
  ```php
  function loginWithDelay($email, $password) {
      $lastAttempt = getLastAttemptTime($email);
      $waitTime = 2 * pow(2, getFailedAttempts($email)); // ุฒูุงุฏุฉ ุฃุณูุฉ
      
      if (time() - $lastAttempt < $waitTime) {
          sleep($waitTime);
      }
      
      // ุงูุชุญูู ูู ุงูุฏุฎูู...
  }
  ```

---

### **6. ููู ูุณุงูู MFA ูู ุชูููู ุงููุฎุงุทุฑุ**
- **MFA**: Multi-Factor Authentication (ูุตุงุฏูุฉ ูุชุนุฏุฏุฉ ุงูุนูุงูู)
- **ุงูุนูุงูู ุงูุซูุงุซุฉ**:
  1. **ุดูุก ุชุนุฑูู**: ูููุฉ ุงููุฑูุฑ
  2. **ุดูุก ุชูููู**: ูุงุชูุ ุจุทุงูุฉ ุฐููุฉ
  3. **ุดูุก ุฃูุช ุนููู**: ุจุตูุฉุ ูุฌู
- **ุงูุชุฃุซูุฑ**: ุญุชู ูู ุณุฑูุช ูููุฉ ุงููุฑูุฑุ ูุญุชุงุฌ ุงูููุงุฌู ููุนุงูู ุงูุซุงูู.
- **ุงูุฃูุซูุฉ**: Google Authenticatorุ SMSุ YubiKey.

---

### **7. ููุงุฐุง ูุง ูุฎุฒู ูููุฉ ุงููุฑูุฑุ**
- **ุงูุณุจุจ ุงููุจุงุดุฑ**: ูู ุณูุฑูุช ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูุง ูุฑูุฏ ูุดู ูููุงุช ูุฑูุฑ ุงููุณุชุฎุฏููู.
- **ุงูุญู**: ุชุฎุฒูู Hash ููุท (ูููุณ Encryption).
- **ุงููุฑู**:  
  - **Encryption**: ูุงุจู ูููู (ุจุงูููุชุงุญ)
  - **Hashing**: ูุง ุฑุฌูุน ููู (ูุญุชุงุฌ ููุท ููุชุญูู)
- **ุงููุจุฏุฃ**: `if (hash(input) == stored_hash)`

---

### **8. ููู ูุชุญูู Login Bug ุฅูู ุงุฎุชุฑุงู ูุงููุ**
- **ุงูุณููุงุฑูู**:
  1. ุซุบุฑุฉ ูู ุตูุญุฉ ุงูุฏุฎูู (SQL Injection)
  2. ุงูููุงุฌู ูุญุตู ุนูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏููู
  3. ูุฌุฏ ูุฏูุฑุงู ุจูููุฉ ูุฑูุฑ ุถุนููุฉ
  4. ูุฏุฎู ููุฏูุฑ
  5. ูุญูู ููู ุฎุจูุซ (Shell)
  6. ูุชุญูู ุจุงูุฎุงุฏู ุจุงููุงูู
- **ุงูุฏุฑุณ**: ุตูุญุฉ ุงูุฏุฎูู ูู ุฃูู ุตูุญุฉ ูุฌุจ ุชุฃููููุง.

---

### **9. ููุงุฐุง ููุนุฏ password_hash ุฃูุถูุ**
- **ุงููุฒุงูุง**:
  1. ูุณุชุฎุฏู ุฎูุงุฑุฒููุงุช ุขููุฉ (bcrypt)
  2. ูุถูู Salt ุชููุงุฆูุงู
  3. ูุฏุนู Cost parameter ูุฒูุงุฏุฉ ุงูุตุนูุจุฉ
  4. ุฌุฒุก ูู PHP core (ูุง ุญุงุฌุฉ ูููุชุจุงุช ุฎุงุฑุฌูุฉ)
- **ุงููุซุงู**:  
  ```php
  // ุงูุชุฎุฒูู
  $hash = password_hash($password, PASSWORD_BCRYPT, ['cost' => 12]);
  
  // ุงูุชุญูู
  if (password_verify($input, $hash)) {
      echo "ุฏุฎูู ูุงุฌุญ";
  }
  ```

---

### **10. ูุชู ุชููู ุงููุตุงุฏูุฉ ูุงุดูุฉุ**
1. **ูุดู ูู ุชุฎุฒูู ูููุงุช ุงููุฑูุฑ**: ุจุฏูู Hashing
2. **ูุดู ูู ุงูุชุญูู**: ุฑุณุงุฆู ุฎุทุฃ ุฏูููุฉ
3. **ูุดู ูู ุงูุญูุงูุฉ**: ูุง rate limiting
4. **ูุดู ูู ุงููุฑุงูุจุฉ**: ูุง ุชุณุฌูู ูููุญุงููุงุช
5. **ูุดู ูู ุงูุชุตููู**: ูุง MFA ููุนูููุงุช ุงูุญุณุงุณุฉ

---

## ๐งช ุฃุณุฆูุฉ (ูุงุฐุง ููุ)

### **1. ูุงุฐุง ูู ุณูุฑูุช ูุงุนุฏุฉ ุงูุจูุงูุงุชุ**
- **ุงูุณููุงุฑูู**: ูุงุนุฏุฉ ุจูุงูุงุช ูุงููุฉ ูุน ูููุงุช ุงููุฑูุฑ.
- **ุฅุฐุง ูุงูุช ูุดูุฑุฉ ุจู MD5**: ูุงุฑุซุฉุ ูููู ูู ูุนุธููุง.
- **ุฅุฐุง ูุงูุช ูุดูุฑุฉ ุจู bcrypt**: ุขูู ูุณุจูุงูุ ููู ูุฌุจ:
  1. ุฅุฎุทุงุฑ ุฌููุน ุงููุณุชุฎุฏููู
  2. ุฅุฌุจุงุฑ ุชุบููุฑ ูููุงุช ุงููุฑูุฑ
  3. ุฅูุบุงุก ุฌููุน ุงูุฌูุณุงุช
  4. ุงูุชุญูู ูู ุงูุฃูุดุทุฉ ุงููุดุจููุฉ

### **2. ูุงุฐุง ูู ุฃูุนูุฏ ุงุณุชุฎุฏุงู Session IDุ**
- **ุงูุซุบุฑุฉ**: Session Fixation Attack.
- **ุงููุฌูู**: ูุนุทู ุงูููุงุฌู Session ID ููุถุญูุฉุ ุซู ูุณุชุฎุฏูู ุจุนุฏ ุชุณุฌูู ุฏุฎูููุง.
- **ุงูููุน**:  
  ```php
  session_start();
  session_regenerate_id(true); // ุฅูุดุงุก Session ID ุฌุฏูุฏ ุจุนุฏ ุงูุฏุฎูู
  ```

### **3. ูุงุฐุง ูู ูู ุชูุญุฏูุฏ ูุญุงููุงุช ุงูุฏุฎููุ**
- **ุงููุชูุฌุฉ**: Brute Force Attack ูููู.
- **ุงููุฌูู**: 10000 ูุญุงููุฉ ูู ุฏูุงุฆู.
- **ุงูุญู**: Rate Limiting + CAPTCHA:  
  ```php
  if (failed_attempts($ip) > 5) {
      require_captcha();
  }
  if (failed_attempts($ip) > 10) {
      block_ip_temporarily($ip);
  }
  ```

### **4. ูุงุฐุง ูู ุงุณุชูุฎุฏูุช ุฑุณุงูุฉ ุฎุทุฃ ุฏูููุฉุ**
- **ุงููุดููุฉ**: ุชุณุงุนุฏ ุงูููุงุฌู ูู ูุนุฑูุฉ ุงูุญุณุงุจุงุช ุงูููุฌูุฏุฉ.
- **ุงูุฎุทุฃ**: "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ููุฌูุฏ" โ ูุนุฑู ุฃู ุงูุญุณุงุจ ุบูุฑ ููุฌูุฏ.
- **ุงูุตุญูุญ**: "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ".

### **5. ูุงุฐุง ูู ูู ุชูุณุฌู ุงููุญุงููุงุชุ**
- **ุงูุฎุทุฑ**: ูุง ุชุนุฑู ุฃู ููุงู ูุฌููุงู.
- **ุงููุชูุฌุฉ**: ูููู ุฃู ูุณุชูุฑ ุงููุฌูู ูุฃูุงู ุฏูู ุงูุชุดุงู.
- **ุงูุญู**: ุณุฌูุงุช ูุน ุชูุงุตูู:  
  ```php
  log_security_event([
      'timestamp' => time(),
      'ip' => $_SERVER['REMOTE_ADDR'],
      'email' => $email,
      'success' => false,
      'user_agent' => $_SERVER['HTTP_USER_AGENT']
  ]);
  ```

---

## โ๏ธ ุชูุฑูู ุชุทุจููู

### **ูุธุงู ุชุณุฌูู ุฏุฎูู ุขูู**

#### **1. ุชุฎุฒูู ูููุงุช ุงููุฑูุฑ ุขูููุง**
```php
class PasswordManager {
    private $cost = 12;
    
    public function hashPassword($password) {
        // ุงูุชุญูู ูู ููุฉ ูููุฉ ุงููุฑูุฑ ุฃููุงู
        if (!$this->isPasswordStrong($password)) {
            throw new InvalidPasswordException();
        }
        
        // ุฅูุดุงุก Hash ุจุงุณุชุฎุฏุงู bcrypt
        $hash = password_hash($password, PASSWORD_BCRYPT, [
            'cost' => $this->cost
        ]);
        
        if ($hash === false) {
            throw new HashingException();
        }
        
        return $hash;
    }
    
    public function verifyPassword($password, $hash) {
        return password_verify($password, $hash);
    }
    
    public function needsRehash($hash) {
        return password_needs_rehash($hash, PASSWORD_BCRYPT, [
            'cost' => $this->cost
        ]);
    }
    
    private function isPasswordStrong($password) {
        if (strlen($password) < 12) return false;
        
        // ูุฌุจ ุฃู ุชุญุชูู ุนูู:
        // ุญุฑู ูุจูุฑุ ุญุฑู ุตุบูุฑุ ุฑููุ ุฑูุฒ
        $checks = [
            '/[A-Z]/', // ุญุฑู ูุจูุฑ
            '/[a-z]/', // ุญุฑู ุตุบูุฑ
            '/[0-9]/', // ุฑูู
            '/[^\w\s]/' // ุฑูุฒ (ุบูุฑ ุญุฑู ุฃู ุฑูู ุฃู ูุณุงูุฉ)
        ];
        
        foreach ($checks as $pattern) {
            if (!preg_match($pattern, $password)) {
                return false;
            }
        }
        
        // ููุน ุงููููุงุช ุงูุดุงุฆุนุฉ
        $commonPasswords = $this->loadCommonPasswords();
        if (in_array(strtolower($password), $commonPasswords)) {
            return false;
        }
        
        return true;
    }
    
    private function loadCommonPasswords() {
        // ูุงุฆูุฉ ุจุงููููุงุช ุงูุดุงุฆุนุฉ (ูุซุงู)
        return [
            'password', '123456', 'qwerty', 'admin',
            'welcome', 'monkey', 'dragon', 'letmein'
        ];
    }
}
```

#### **2. ุฑุณุงุฆู ุฎุทุฃ ููุญุฏุฉ**
```php
class AuthenticationResponse {
    const ERROR_MESSAGE = 'ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ';
    const SUCCESS_MESSAGE = 'ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ';
    const ACCOUNT_LOCKED = 'ุชู ุชุนููู ุงูุญุณุงุจ ูุคูุชุงู. ุญุงูู ูุฑุฉ ุฃุฎุฑู ูุงุญูุงู.';
    
    public static function getError($type = 'generic') {
        // ุฏุงุฆูุงู ููุณ ุงูุฑุณุงูุฉ ููุฃุฎุทุงุก ุงูุนุงูุฉ
        switch ($type) {
            case 'locked':
                return self::ACCOUNT_LOCKED;
            case 'captcha':
                return 'ุงูุฑุฌุงุก ุฅููุงู ุงุฎุชุจุงุฑ CAPTCHA';
            default:
                return self::ERROR_MESSAGE;
        }
    }
    
    public static function getSuccess() {
        return self::SUCCESS_MESSAGE;
    }
}

// ุงูุงุณุชุฎุฏุงู
$response = new AuthenticationResponse();
echo $response::getError(); // ููุณ ุงูุฑุณุงูุฉ ุฏุงุฆูุงู
```

#### **3. ููุน brute force**
```php
class BruteForceProtection {
    private $db;
    private $maxAttempts = 5;
    private $lockTime = 900; // 15 ุฏูููุฉ
    private $baseDelay = 2; // 2 ุซูุงูู
    
    public function checkAttempt($identifier, $ip) {
        // ุงูุญุตูู ุนูู ุนุฏุฏ ุงููุญุงููุงุช ุงููุงุดูุฉ
        $attempts = $this->getFailedAttempts($identifier, $ip);
        
        // ุงูุชุญูู ุฅุฐุง ุชู ุญุธุฑ ุงููุนุฑู
        if ($this->isLocked($identifier)) {
            throw new AccountLockedException();
        }
        
        // ุฒูุงุฏุฉ ุงูุชุฃุฎูุฏ ุงูุชุตุงุนุฏู
        if ($attempts > 0) {
            $delay = $this->baseDelay * pow(2, $attempts - 1);
            sleep($delay);
        }
        
        // ุงูุชุญูู ุฅุฐุง ุชุฌุงูุฒ ุงูุญุฏ
        if ($attempts >= $this->maxAttempts) {
            $this->lockAccount($identifier);
            throw new AccountLockedException();
        }
        
        return true;
    }
    
    public function recordAttempt($identifier, $ip, $success) {
        $timestamp = time();
        
        if ($success) {
            // ูุณุญ ุงููุญุงููุงุช ุงููุงุดูุฉ ุนูุฏ ูุฌุงุญ ุงูุฏุฎูู
            $this->clearFailedAttempts($identifier);
        } else {
            // ุชุณุฌูู ูุญุงููุฉ ูุงุดูุฉ
            $this->logFailedAttempt($identifier, $ip, $timestamp);
            
            // ุฒูุงุฏุฉ ุงูุนุฏุงุฏ
            $attempts = $this->getFailedAttempts($identifier, $ip) + 1;
            
            // ุฅุฐุง ุชุฌุงูุฒ ุงูุญุฏุ ุญุธุฑ ุงูุญุณุงุจ
            if ($attempts >= $this->maxAttempts) {
                $this->lockAccount($identifier);
            }
        }
        
        // ุชุณุฌูู ูู ุณุฌูุงุช ุงูุฃูุงู
        $this->logSecurityEvent($identifier, $ip, $success, $timestamp);
    }
    
    private function getFailedAttempts($identifier, $ip) {
        // ุงูุจุญุซ ูู ุขุฎุฑ ุณุงุนุฉ
        $timeLimit = time() - 3600;
        
        $stmt = $this->db->prepare("
            SELECT COUNT(*) as attempts 
            FROM login_attempts 
            WHERE (identifier = ? OR ip = ?) 
            AND timestamp > ? 
            AND success = 0
        ");
        $stmt->execute([$identifier, $ip, $timeLimit]);
        
        return $stmt->fetchColumn();
    }
    
    private function isLocked($identifier) {
        $stmt = $this->db->prepare("
            SELECT lock_until 
            FROM account_locks 
            WHERE identifier = ? 
            AND lock_until > ?
        ");
        $stmt->execute([$identifier, time()]);
        
        return $stmt->rowCount() > 0;
    }
    
    private function lockAccount($identifier) {
        $lockUntil = time() + $this->lockTime;
        
        $stmt = $this->db->prepare("
            INSERT INTO account_locks (identifier, lock_until) 
            VALUES (?, ?) 
            ON DUPLICATE KEY UPDATE lock_until = ?
        ");
        $stmt->execute([$identifier, $lockUntil, $lockUntil]);
    }
    
    private function logSecurityEvent($identifier, $ip, $success, $timestamp) {
        $stmt = $this->db->prepare("
            INSERT INTO security_logs 
            (identifier, ip, success, timestamp, user_agent) 
            VALUES (?, ?, ?, ?, ?)
        ");
        $stmt->execute([
            $identifier,
            $ip,
            $success ? 1 : 0,
            $timestamp,
            $_SERVER['HTTP_USER_AGENT']
        ]);
    }
}
```

#### **4. ุชุณุฌูู ุงููุญุงููุงุช**
```php
class LoginLogger {
    private $db;
    
    public function logAttempt($email, $ip, $success, $details = []) {
        $stmt = $this->db->prepare("
            INSERT INTO login_logs 
            (email, ip, success, timestamp, user_agent, details) 
            VALUES (?, ?, ?, ?, ?, ?)
        ");
        
        $detailsJson = json_encode(array_merge($details, [
            'country' => $this->getCountryFromIP($ip),
            'browser' => $this->getBrowserInfo()
        ]));
        
        $stmt->execute([
            $email,
            $ip,
            $success ? 1 : 0,
            time(),
            $_SERVER['HTTP_USER_AGENT'],
            $detailsJson
        ]);
        
        // ุฅุฐุง ูุงูุช ูุญุงููุฉ ูุงุดูุฉุ ุชุญูู ูู ุงูุฃููุงุท ุงููุดุจููุฉ
        if (!$success) {
            $this->checkSuspiciousPatterns($email, $ip);
        }
    }
    
    private function checkSuspiciousPatterns($email, $ip) {
        // ุงูุชุญูู ูู ูุญุงููุงุช ูุชุนุฏุฏุฉ ูู ุนูุงููู IP ูุฎุชููุฉ
        $stmt = $this->db->prepare("
            SELECT COUNT(DISTINCT ip) as unique_ips
            FROM login_logs 
            WHERE email = ? 
            AND timestamp > ?
            AND success = 0
        ");
        $stmt->execute([$email, time() - 3600]); // ุขุฎุฑ ุณุงุนุฉ
        
        $uniqueIPs = $stmt->fetchColumn();
        
        if ($uniqueIPs > 3) {
            $this->triggerAlert("Multiple IPs for email: $email");
        }
        
        // ุงูุชุญูู ูู ูุนุฏู ุงููุญุงููุงุช
        $stmt = $this->db->prepare("
            SELECT COUNT(*) as attempts
            FROM login_logs 
            WHERE ip = ? 
            AND timestamp > ?
            AND success = 0
        ");
        $stmt->execute([$ip, time() - 300]); // ุขุฎุฑ 5 ุฏูุงุฆู
        
        $attempts = $stmt->fetchColumn();
        
        if ($attempts > 10) {
            $this->triggerAlert("High rate from IP: $ip");
            $this->temporaryBlockIP($ip);
        }
    }
    
    private function triggerAlert($message) {
        // ุฅุฑุณุงู ุชูุจูู ูููุณุคูููู
        $alert = [
            'timestamp' => time(),
            'message' => $message,
            'severity' => 'high'
        ];
        
        // ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        $this->db->prepare("INSERT INTO security_alerts VALUES (?, ?, ?)")
                ->execute([time(), $message, 'high']);
        
        // ุฅุฑุณุงู ุฅูููู (ุงุฎุชูุงุฑู)
        // mail('admin@site.com', 'Security Alert', $message);
    }
}
```

#### **5. ูุธุงู ุชุณุฌูู ุฏุฎูู ูุงูู**
```php
class SecureLoginSystem {
    private $passwordManager;
    private $bruteForceProtection;
    private $logger;
    
    public function __construct() {
        $this->passwordManager = new PasswordManager();
        $this->bruteForceProtection = new BruteForceProtection();
        $this->logger = new LoginLogger();
    }
    
    public function login($email, $password) {
        // ุชูุธูู ุงููุฏุฎูุงุช
        $email = filter_var($email, FILTER_SANITIZE_EMAIL);
        
        if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
            return $this->getGenericError();
        }
        
        $ip = $_SERVER['REMOTE_ADDR'];
        
        try {
            // ุงูุชุญูู ูู ุญูุงูุฉ Brute Force
            $this->bruteForceProtection->checkAttempt($email, $ip);
            
            // ุงูุจุญุซ ุนู ุงููุณุชุฎุฏู
            $user = $this->getUserByEmail($email);
            
            if (!$user) {
                // ุญุชู ูู ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏุ ูุณุฌู ูุญุงููุฉ ูุงุดูุฉ
                $this->bruteForceProtection->recordAttempt($email, $ip, false);
                $this->logger->logAttempt($email, $ip, false, [
                    'reason' => 'user_not_found'
                ]);
                
                return $this->getGenericError();
            }
            
            // ุงูุชุญูู ูู ูููุฉ ุงููุฑูุฑ
            if (!$this->passwordManager->verifyPassword($password, $user['password_hash'])) {
                // ูููุฉ ุงููุฑูุฑ ุฎุงุทุฆุฉ
                $this->bruteForceProtection->recordAttempt($email, $ip, false);
                $this->logger->logAttempt($email, $ip, false, [
                    'reason' => 'wrong_password',
                    'user_id' => $user['id']
                ]);
                
                return $this->getGenericError();
            }
            
            // ุงูุชุญูู ุฅุฐุง ูุงูุช ูููุฉ ุงููุฑูุฑ ุจุญุงุฌุฉ ูุฅุนุงุฏุฉ Hash
            if ($this->passwordManager->needsRehash($user['password_hash'])) {
                $newHash = $this->passwordManager->hashPassword($password);
                $this->updatePasswordHash($user['id'], $newHash);
            }
            
            // ุชุณุฌูู ุงูุฏุฎูู ุงููุงุฌุญ
            $this->bruteForceProtection->recordAttempt($email, $ip, true);
            $this->logger->logAttempt($email, $ip, true, [
                'user_id' => $user['id']
            ]);
            
            // ุฅูุดุงุก ุฌูุณุฉ ุขููุฉ
            $this->createSecureSession($user);
            
            // ุชุณุฌูู ุขุฎุฑ ููุช ุฏุฎูู
            $this->updateLastLogin($user['id']);
            
            return [
                'success' => true,
                'message' => AuthenticationResponse::getSuccess(),
                'user' => $this->sanitizeUserData($user)
            ];
            
        } catch (AccountLockedException $e) {
            return [
                'success' => false,
                'message' => AuthenticationResponse::getError('locked')
            ];
        } catch (Exception $e) {
            // ุฎุทุฃ ุบูุฑ ูุชููุน
            error_log("Login error: " . $e->getMessage());
            return $this->getGenericError();
        }
    }
    
    public function register($email, $password, $userData = []) {
        // ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
        if ($this->userExists($email)) {
            return $this->getGenericError(); // ููุณ ุงูุฑุณุงูุฉ
        }
        
        // ุงูุชุญูู ูู ููุฉ ูููุฉ ุงููุฑูุฑ
        if (!$this->passwordManager->isPasswordStrong($password)) {
            return [
                'success' => false,
                'message' => 'ูููุฉ ุงููุฑูุฑ ุถุนููุฉ. ูุฌุจ ุฃู ุชุญุชูู ุนูู 12 ุญุฑูุงู ุนูู ุงูุฃููุ ูุชุดูู ุฃุญุฑู ูุจูุฑุฉ ูุตุบูุฑุฉ ูุฃุฑูุงูุงู ูุฑููุฒุงู.'
            ];
        }
        
        // ุฅูุดุงุก Hash ููููุฉ ุงููุฑูุฑ
        $passwordHash = $this->passwordManager->hashPassword($password);
        
        // ุญูุธ ุงููุณุชุฎุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
        $userId = $this->createUser($email, $passwordHash, $userData);
        
        // ุฅุฑุณุงู ุจุฑูุฏ ุงูุชุญูู
        $this->sendVerificationEmail($email);
        
        return [
            'success' => true,
            'message' => 'ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ. ุงูุฑุฌุงุก ุงูุชุญูู ูู ุจุฑูุฏู ุงูุฅููุชุฑููู.'
        ];
    }
    
    private function getGenericError() {
        return [
            'success' => false,
            'message' => AuthenticationResponse::getError()
        ];
    }
    
    private function createSecureSession($user) {
        session_start();
        
        // ุฅุนุฏุงุฏุงุช ุขููุฉ ููุฌูุณุฉ
        ini_set('session.cookie_httponly', 1);
        ini_set('session.cookie_secure', 1);
        ini_set('session.cookie_samesite', 'Strict');
        
        // ุฅูุดุงุก Session ID ุฌุฏูุฏ
        session_regenerate_id(true);
        
        // ุชุฎุฒูู ุจูุงูุงุช ุงููุณุชุฎุฏู (ุจุฏูู ุจูุงูุงุช ุญุณุงุณุฉ)
        $_SESSION['user_id'] = $user['id'];
        $_SESSION['email'] = $user['email'];
        $_SESSION['role'] = $user['role'];
        $_SESSION['login_time'] = time();
        $_SESSION['session_id'] = session_id();
        
        // ุฅุถุงูุฉ Token ูููุน CSRF
        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
    }
}
```

#### **6. ุงุฎุชุจุงุฑ ุงูุณููุงุฑูููุงุช ุงูุฎุงุทุฆุฉ**
```php
class LoginSecurityTest {
    private $loginSystem;
    
    public function runTests() {
        $results = [];
        
        // ุงุฎุชุจุงุฑ 1: ูุฌูู Brute Force
        $results[] = $this->testBruteForce();
        
        // ุงุฎุชุจุงุฑ 2: Information Disclosure
        $results[] = $this->testInformationDisclosure();
        
        // ุงุฎุชุจุงุฑ 3: SQL Injection
        $results[] = $this->testSQLInjection();
        
        // ุงุฎุชุจุงุฑ 4: Session Fixation
        $results[] = $this->testSessionFixation();
        
        // ุงุฎุชุจุงุฑ 5: Weak Passwords
        $results[] = $this->testWeakPasswords();
        
        return $results;
    }
    
    private function testBruteForce() {
        $attempts = 10;
        $email = 'test@example.com';
        
        echo "ุงุฎุชุจุงุฑ ุญูุงูุฉ Brute Force ($attempts ูุญุงููุงุช)...\n";
        
        for ($i = 1; $i <= $attempts; $i++) {
            $start = microtime(true);
            $result = $this->loginSystem->login($email, 'wrongpass' . $i);
            $end = microtime(true);
            
            $time = $end - $start;
            echo "ุงููุญุงููุฉ $i: $time ุซุงููุฉ - " . $result['message'] . "\n";
            
            // ุจุนุฏ ุงููุญุงููุฉ ุงูุฎุงูุณุฉุ ูุฌุจ ุฃู ูููู ููุงู ุชุฃุฎูุฑ ูุจูุฑ
            if ($i >= 5 && $time < 1) {
                return "FAIL: No delay on attempt $i";
            }
        }
        
        return "PASS: Brute force protection working";
    }
    
    private function testInformationDisclosure() {
        echo "ุงุฎุชุจุงุฑ Information Disclosure...\n";
        
        // ูุญุงููุฉ ุฏุฎูู ุจุญุณุงุจ ููุฌูุฏ ุจูููุฉ ุฎุงุทุฆุฉ
        $result1 = $this->loginSystem->login('existing@example.com', 'wrongpass');
        
        // ูุญุงููุฉ ุฏุฎูู ุจุญุณุงุจ ุบูุฑ ููุฌูุฏ
        $result2 = $this->loginSystem->login('nonexistent@example.com', 'wrongpass');
        
        // ุงูุฑุณุงูุฉ ูุฌุจ ุฃู ุชููู ููุณูุง
        if ($result1['message'] === $result2['message']) {
            return "PASS: Generic error messages";
        } else {
            return "FAIL: Different error messages reveal account existence";
        }
    }
    
    private function testSQLInjection() {
        echo "ุงุฎุชุจุงุฑ SQL Injection...\n";
        
        $payloads = [
            "' OR '1'='1",
            "admin' --",
            "\" OR \"1\"=\"1",
            "'; DROP TABLE users; --"
        ];
        
        foreach ($payloads as $payload) {
            $result = $this->loginSystem->login($payload, $payload);
            
            // ูุฌุจ ุฃู ูุนูุฏ ุฑุณุงูุฉ ุฎุทุฃ ุนุงูุฉุ ููุณ ุฎุทุฃ ูุงุนุฏุฉ ุจูุงูุงุช
            if (strpos($result['message'], 'SQL') !== false ||
                strpos($result['message'], 'database') !== false) {
                return "FAIL: SQL error revealed with payload: $payload";
            }
        }
        
        return "PASS: SQL Injection prevented";
    }
    
    private function testSessionFixation() {
        echo "ุงุฎุชุจุงุฑ Session Fixation...\n";
        
        session_id('attacker_session_id');
        $this->loginSystem->login('test@example.com', 'password123');
        $newSessionId = session_id();
        
        if ($newSessionId === 'attacker_session_id') {
            return "FAIL: Session ID not regenerated";
        } else {
            return "PASS: Session ID regenerated after login";
        }
    }
    
    private function testWeakPasswords() {
        echo "ุงุฎุชุจุงุฑ ูููุงุช ุงููุฑูุฑ ุงูุถุนููุฉ...\n";
        
        $weakPasswords = [
            'password',
            '123456',
            'qwerty',
            'admin123',
            'letmein'
        ];
        
        foreach ($weakPasswords as $password) {
            $result = $this->loginSystem->register('test@example.com', $password);
            
            if ($result['success']) {
                return "FAIL: Weak password accepted: $password";
            }
        }
        
        return "PASS: Weak passwords rejected";
    }
}

// ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช
$test = new LoginSecurityTest();
$results = $test->runTests();

echo "\n=== ูุชุงุฆุฌ ุงุฎุชุจุงุฑ ุงูุฃูุงู ===\n";
foreach ($results as $result) {
    echo "- $result\n";
}
```

---

## โ ุงูุฎูุงุตุฉ

1. **ุงุณุชุฎุฏู password_hash() ุฏุงุฆูุงู**: bcrypt ุฃู Argon2.
2. **ุฑุณุงุฆู ุฎุทุฃ ุนุงูุฉ**: ูุง ุชูุดู ูุนูููุงุช.
3. **Rate Limiting ุถุฑูุฑู**: ุถุฏ Brute Force.
4. **ุณุฌู ูู ุดูุก**: ูููุฑุงูุจุฉ ูุงูุชุญููู.
5. **ุฌุฏุฏ Session ID**: ุจุนุฏ ุงูุฏุฎูู.
6. **ุชุญูู ูู ููุฉ ูููุงุช ุงููุฑูุฑ**: 12 ุญุฑูุงู ูุน ุชุนููุฏ.
7. **ููุฑ ูู MFA**: ูููุณุชุฎุฏููู ุงููููุฒูู.
8. **ุงุฎุชุจุงุฑ ุงูุดููููุฉ**: ุฌููุน ุงูุณููุงุฑูููุงุช ุงูุณูุฆุฉ.
